#!/bin/sh
#
# nessus-rmuser
#
# Written by Renaud Deraison <deraison@cvs.nessus.org>
#
# This script is distributed under the Gnu General Public License (GPL)
#

prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=@bindir@
sbindir=@sbindir@
libexecdir=@libexecdir@
datadir=@datadir@
sysconfdir=@sysconfdir@
sharedstatedir=@sharedstatedir@
localstatedir=@localstatedir@
libdir=@libdir@
includedir=@includedir@
oldincludedir=@oldincludedir@
infodir=@infodir@
mandir=@mandir@
is_cygwin=@is_cygwin@

nessusd=@sbindir@/nessusd
nessusd_users=@sysconfdir@/nessus/nessusd.users

# check if gettext is present

if [ -f /usr/bin/gettext.sh ];
then

  # initialize gettext

  . gettext.sh
  export TEXTDOMAIN=nessus-scripts
  export TEXTDOMAINDIR=@datadir@/locale

else

  # define dummy functions

  gettext () {
    echo $1
  }

  eval_gettext () {
    echo $1
  }

fi

#
# check whether we have echo -n, depending
# on the current shell, used
case `echo -n` in
\-n)	Xn=   ; Xc='\c' ;;
*)	Xn=-n ; Xc=
esac

if [ -z "$is_cygwin" ];
then
 # make sure that we are root
 case `id` in uid=0*) ;; *)
    gettext "Only root should use nessus-rmuser."; echo
    exit 1
 esac
fi


login="$1"

test -z "$login" && {
echo $Xn "`gettext "Login to remove :"` $Xc"
read login
}

test -z "$login" && {
 gettext "No login entered"
 exit 1
}

if [ -d "$localstatedir/nessus/users/$login" ];
then
 rm -rf "$localstatedir/nessus/users/$login"
 gettext "user removed."; echo
else
 gettext "user does not exist"; echo
fi
