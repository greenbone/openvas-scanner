2011-03-16  Henri Doreau <henri.doreau@greenbone.net>

	* src/locks.c (file_lock, file_locked): Close file descriptors before
	return.

	* src/save_kb.c (save_kb_load_kb): Close stream before return.

2011-03-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/greenbone-nvt-sync: Fix conditionals so that they are
	evaluated as intended.

2011-03-07  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/openvas-nvt-sync.in: Removed last bashism from
	openvas-nvt-sync a second time: Drop SIG prefix when referring to
	signal as it is a bashism as well.

2011-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Ensure that a "gnupg" directory is created in the
	OpenVAS configuration directory with the correct permissions as a
	preparation for signature verifications.

2011-03-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Enable the generation of code documentation. Spotted by Michael Meyer.

	* doc/CMakeLists.txt: New. Add to enable the generation of code
	documentation.

	* doc/Doxyfile.in, doc/Doxyfile_full.in: Fix value of INPUT to match
	the current paths.

2011-02-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Set to version to 3.2.3.

2011-02-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.2.2 release.

	* CHANGES: Updated.

2011-02-17  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/greenbone-nvt-sync: Log feed name, version and NVT count
	before and after each sync.

2011-02-17  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/openvas-nvt-sync.in: Remove last bashism from
	openvas-nvt-sync: Refer to signals by name, not by number.

2011-02-17  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/preferences.h: Remove unimplemented function declaration for
	preferences_get_delay_between_tests.

2011-02-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Set to version to 3.2.2.

2011-02-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.2.1 release.

	* CHANGES: Updated.

2011-02-16  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/preferences.c: Add default value for the preference
	"unscanned_closed".

2011-02-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/greenbone-nvt-sync: Remove redundant rsync flag. Spotted by
	Lukas Grunwald.

2011-02-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/greenbone-nvt-sync: Clean up bashisms, make checks for command
	availability more reliable.

2011-02-11  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/greenbone-nvt-sync: Improve behaviour when no init scripts are
	available.

2011-02-09  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Ensure OPENVAS_CACHE_DIR and OPENVAS_NVT_DIR are
	created on install.

2011-02-09  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Eliminate trailing whitespace in flags as it leads
	to trouble. Replace use of deprecated exec_program with
	execute_process.

2011-02-08  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Ensure openvassd is installed with the correct
	permissions.

2011-02-07  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt, src/CMakeLists.txt: Move handling of configuration
	and installation to top level CMakeLists.txt.

2011-02-07  Michael Wiegand <michael.wiegand@greenbone.net>

	* doc/openvassd.8.in: Fix typo, remove outdated information.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Set to version to 3.2.1.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.2.0 release.

	* CMakeLists.txt: Updated.

2011-02-03  Stephan Kleine

	* src/CMakeLists.txt: explicitly link against gcrypt

2011-02-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CHANGES: Updated for upcoming 3.2.0 release.

2011-02-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Added missing man page install directive.

2011-02-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Install man pages into the correct directory
	according to the FHS.

2011-02-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Move installation of openvas-services file from openvas-scanner to
	openvas-libraries since the only function using it resides in
	openvas-libraries.

	* openvas-services: Removed. Is now openvas-libraries/openvas-services.

	* CMakeLists.txt: Remove handling of openvas-services.

2011-02-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Removed superfluous check for openvas_base.

2011-02-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Switch openvas-scanner to pkg-config.

	* CMakeLists.txt: Move checks for openvas-libraries, glib and gnutls
	to pkg-config.

	* INSTALL: Update requirements and installation instructions.

	* src/CMakeLists.txt: Replace calls to libopenvas-config with the
	appropriate pkg-config calls.

2011-01-31  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/preferences.c: Fixed glib include.
	(preferences_process): Remove own parsing of settings file and use the
	functionality provided by openvas-libraries instead.

2011-01-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* tools/openvas-adduser.in: Removed checking code for openvassd
	config as it is handled differently now.

2011-01-27  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/greenbone-nvt-sync: Check whether the access key has a size
	greater than zero instead of just testing for existence during self
	test.

2011-01-27  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/greenbone-nvt-sync: Check whether credentials were read
	correctly before attempting to synchronize.

2011-01-25  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/greenbone-nvt-sync: Removed superfluous check for
	openvassd.conf.

2011-01-24  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/openvassd.c (main): Unhide "--cfg-specs" from --help and
	provide a short description.

2011-01-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post-release version bump.

	* CMakeLists.txt: Set to 3.2+rc3.

2011-01-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the openvas-scanner 3.2+rc2 release.

	* CMakeLists.txt: Added some files to ignore for CPack.

	* CHANGES: Updated.

2011-01-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/HTTP_authentication.txt: Removed. There is no
	new or helpful information in there.
 
	* src/COPYING: Removed. Since we maintain a explicit
	list in COPYING, we don't need that file anymore.

2011-01-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* tools/openvas-mkcert.in: Added switch "-f" to
	force overwriting existing certificates.
	Added a stop-mechanism with respective note
	in case the certificate files already exist.

	* doc/openvas-mkcert.8: Added info about "-f" switch.

2011-01-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* tools/openvas-mkcert.in: Removed test of openvassd as it is
	not necessary anymore. Remove client part as it is completly
	commented out anyway.

	* doc/openvas-mkcert.8: Updated.

2011-01-20  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/openvas-mkcert.in: Remove handling of openvassd.conf from
	openvas-mkcert since the default locations of the keys and
	certificates are already known to the scanner.

2011-01-20  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/openvassd.c (main): Remove hidden command line option
	"--gen-config" since it has become meaningless now.

2011-01-20  Michael Wiegand <michael.wiegand@greenbone.net>

	Add default values for settings to the code to remove the dependence
	on a separate openvassd.conf settings file.

	* src/preferences.c: Add list of standard settings.
	(preferences_process): Initialize with standard settings and process
	settings file afterwards.
	(preferences_new): Removed. Default settings are kept internally now.

2011-01-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/openvassd.c (main): Removed useless check for port
	as always a sensible is set.

2011-01-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/openvassd.c (main): Removed command line option
	"--dump-cfg" as it returns no valueable information.

	* doc/openvassd.8.in: Updated accordingly. Updated date
	and improved titel and description. Added "-f" in synopsis.
	Extended authors section to explain some more background.

2011-01-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/openvassd.8.in: New default port is 9391.

2011-01-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/openvassd.c (init_openvassd, main): Renamed any variables
	"iana_port" to "scanner_port". These are only used in this module.
	(main): Set default port to 9391.

2011-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/CMakeLists.txt: Add SYSCONFDIR to definitions.

	* src/openvassd.c (main): Return SYSCONFDIR instead of OPENVAS_SYSCONF_DIR
	for -y, to match the pre-cmake behaviour.

2011-01-19  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/preferences.c (preferences_new): Add preferences for vhost
	scanning to initial configuration file.

2011-01-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Reverted wrongly changed patch version.

	* INSTALL: Updated for OpenVAS-4.

2011-01-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/openvassd.c: Removed code path for not HAVE_SETSID.
	Removed code patch for HAVE_ADDR2ASCII and HAVE_INET_NETA.

2011-01-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/nasl_plugins.c, src/attack.c, src/save_kb.c, src/pluginlaunch.c,
	src/oval_plugins.c, src/comm.c, src/pluginscheduler.c: Change include
	patch for nvt_categories.h.

	* .root-dir: Removed. This as a woraround file for the old build
	environment.

2011-01-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removing framework for binary plugins as they are gone now.

	* src/nes_plugins.c: Removed.

	* src/CMakeLists.txt: Removed handling of module nes_plugins.

	* src/pluginload.c (init_plugin_classes): Removed nes_plugin_class
	from the class list.

	* src/pluginload.h (nes_plugin_class): Removed.

	* COPYING: Removed cnvt entries, renamed "openvassd/" to "src/"
	and added missing entry for openvas-rmuser.in.

2011-01-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/find_service/find_service.c, cnvts/find_service/Makefile,
	cnvts/find_service/, cnvts/make_world,
	cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c,
	cnvts/openvas_tcp_scanner/Makefile, cnvts/openvas_tcp_scanner/,
	cnvts/install_plug, cnvts/synscan/synscan.c, cnvts/synscan/Makefile,
	cnvts/synscan/, cnvts/: Removed. The binary NVTs have been
	turned into built-in NVTs and the source code is now part
	of nasl module of openvas-libries.

2011-01-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/TODO.txt: Removed. It was hopeless out of date
	from the pre-OpenVAS times.

2011-01-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/openvas-nvt-sync.8: Added feed name. Removed reference
	to openvas-client.

	* doc/greenbone-nvt-sync.8: New. First raw version of a man page
	for completeness reason.

	* COPYING: Removed a doubled entry.

2011-01-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* INSTALL: Updated and harmonized with INSTALL of openvas-manager.

2011-01-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/openvassd.8.in: Consolidated variable replacement
	of cmake processing.

	* CMakeLists.txt: Added configuration of openvassd.8 and
	added installation of all the man pages.

2011-01-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Install openvas-services.

2011-01-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* tools/openvas-mkcert-client.in, tools/openvas-nvt-sync.in,
	tools/openvas-mkcert.in, tools/openvas-rmuser.in:
	Consolidated variable replacement of cmake processing.

	* CMakeLists.txt: Added configuration and installation of
	the remaining shell scripts from tools/ directory.
	Using @ONLY for the configuration.

	* tools/openvas-adduser.in: Reverted prompt variable setting
	change now that we use @ONLY.

2011-01-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Remove trailing tab.  Format old entries properly.

2011-01-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/CMakeLists.txt: Added -ldl for linking. Spotted by
	Stefan Schwarz.

2011-01-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* tools/openvas-adduser.in: Consolidated variable replacement
	of cmake processing.

	* CMakeLists.txt: Added configuring and installing of script
	openvas-adduser.

2011-01-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/otp_1_0.c: Renamed makro OPENVAS_VERSION to OPENVASSD_VERSION.

	* src/preferences.c: Renamed OPENVASSD_PLUGINS to OPENVAS_NVT_DIR,
	OPENVASSD_CACHE to OPENVAS_CACHE_DIR, PLUGIN_TIMEOUT to NVT_TIMEOUT.

	* src/users.c: Replaced OPENVASSD_LOGINS by OPENVAS_USERS_DIR.

	* src/oval_plugins.c: Replaced OPENVAS_FULL_VERSION by
	OPENVASSD_VERSION.

	* src/openvassd.c: Added definition of OPENVAS_IANA_OTP_PORT,
	OPENVASSD_CONNECT_RATE and OPENVASSD_CONNECT_BLOCKER. These were
	previously in config.h. Replaced OPENVAS_FULL_VERSION by
	OPENVASSD_VERSION, OPENVASSD_CONFDIR by OPENVAS_SYSCONF_DIR.

	* src/comm.c: Replaced OPENVAS_VERSION by OPENVASSD_VERSION.

	* CMakeLists.txt: New. The master cmake control file.

	* src/CMakeLists.txt: New. The control file for building
	the actual scanner.

2011-01-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/nasl_plugins.c, src/otp_1_0.c, src/preferences.c,
	src/ntp_11.c, src/attack.c, src/shared_socket.c, src/nes_plugins.c,
	src/pluginlaunch.c, src/users.c, src/oval_plugins.c, src/openvassd.c,
	src/log.c, src/rules.c, src/comm.c: Remove include of config.h
	and corevers.h. The variables will now be passed directly via cmake.

	* VERSION.in: Replaced version number by respective variable
	passed by cmake.

2011-01-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, VERSION.in: Renamed VERSION to VERSION.in.

	* doc/Doxyfile.in, doc/Doxyfile_full.in: Replaced project
	number by respective variable passed by cmake.

2011-01-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/Doxyfile, doc/Doxyfile.in: Renamed Doxyfile to Doyfile.in.

	* doc/Doxyfile_full, doc/Doxyfile_full.in: Renamed Doxyfile_full
	to Docyfile_fill.in.

2011-01-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/OBJ/, src/OBJ/.createdir: Removed. Not needed anymore
	in a cmake build environment.

2011-01-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/, openvassd/: Renamed openvassd to src in order to
	be consistent with other OpenVAS modules.

2011-01-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	First step of migrating from autotools to cmake.

	* configure, configure.in, config.guess, ltmain.sh, config.sub,
	aclocal.m4, install-sh: Removed. This is mostly stuff of the
	autotools environment.

	* include/config.h.in, include/corevers.h.in, include/: Removed.
	These include files contain makros that will be directly passed
	to the compiler with the cmake environment.

	* openvas.tmpl.in, Makefile, openvassd/Makefile: Removed.
	This is the Makefile-part. The cmake environment
	will build Makefiles directly.

	* MANIFEST: Removed. Cmake brings its own packaging scheme.

2011-01-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* INSTALL: Fixed typo.

2011-01-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* include/config.h.in: Removed various unsed defines.

2011-01-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/find_service/find_service.c: Made several
	functions static that were forgotten somehow.
	Remove a K&R style declaration.

2011-01-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* configure.in: Removed more of the pthread handling.

	* configure: Updated.

2011-01-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removing OVS_COMPILER, OVS_OS_NAME and OVS_OS_VERSION.
	These do not deliver real value. Removing them simplifies
	build process.

	* include/corevers.h.in (OVS_COMPILER, OVS_OS_NAME, OVS_OS_VERSION):
	Removed.

	* configure.in: Removed handling of OVS_COMPILER, OVS_OS_NAME,
	OVS_OS_VERSION.

	* openvassd/openvassd.c (main): Don't print Compiler version,
	operating system and version on --dumpg-cfg.

	* openvassd/comm.c (comm_send_preferences): Don't send server_info_os
	and server_info_os_version anymore for "SERVER <|> PREFERENCES".

2011-01-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/oval_plugins.c (ovaldi_launch): Replaced PROGNAME by its
	static string "OpenVAS".

	* include/corevers.h.in: Removed PROGNAME.

2011-01-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Remove unused and broken elements of trying to abstract
	different threading models. Adding thread-support should
	be done cleanly from ground up anew, if at all.

	* configure.in, openvas.tmpl.in, include/config.h.in: Removed
	PTHREAD handling.

	* openvassd/nasl_plugins.c: Remove include of threadcompat.h.
	(nasl_plugin_launch): module now is an int.

	* openvassd/attack.c: Remove include of threadcompat.h.
	(attack_network): pid now is an int.

	* openvassd/shared_socket.c: Remove include of threadcompat.h
	(struct shared_fd): current_users and creator now are int.
	(openvassd_shared_socket_register, openvassd_shared_socket_acquire,
	openvassd_shared_socket_release, openvassd_shared_socket_destroy,
	shared_socket_process): Parameter pid is not an int.
	(shared_socket_cleanup_process): Parameter process is not an int.

	* openvassd/shared_socket.h: Adjusted protos accordingly.

	* openvassd/nes_plugins.c: Remove include of threadcompat.h.
	(ext_library_t, LOAD_FUNCTION, LIB_LAST_ERROR, CLOSE_LIBRARY):
	Copied here from threadcompat.h.
	(nes_plugin_launch): module is now an int.

	* openvassd/pluginlaunch.c: Remove include of threadcompat.h.
	(struct running): pid now is an int.
	(process_mgr_sighand_term): Replaced _EXIT() by _exit().

	* openvassd/openvassd.c (scanner_thread, main): Removed code paths
	for USE_PTHREADS as this is not supported anymore anyway.

	* openvassd/comm.c (comm_send_preferences): Remove conditional
	USE_FORK_THREADS as we always use forks.

	* include/threadcompat.h: Removed.

	* MANIFEST: Updated.

2011-01-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* include/includes.h: Removed.

	* MANIFEST: Updated.

2011-01-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/openvassd.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of EXIT()
	by exit() and DO_EXIT() by exit().

2011-01-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/sighand.c: Replaced use of includes.h
	by respective direct includes.
	(let_em_die): We assume we have always waitpid() available
	and don't try to fall back to wait4() or wait3().
	(openvas_signal): Assume we always have sa_restorer.
	(sighandler, sighand_segv): Always use _exit() and don't try
	to fall back to exit(). Replace call of _EXIT() by exit().

	* openvassd/shared_socket.c: Replaced use of includes.h
	by respective direct includes.

2011-01-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/plugs_req.c: Replaced use of includes.h
	by respective direct includes.

	* openvassd/piic.c: Replaced use of includes.h
	by respective direct includes.

	* openvassd/processes.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of EXIT()
	by exit() and _EXIT() by _exit().

	* openvassd/attack.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of EXIT()
	by exit().

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/oval_plugins.c: Replaced use of includes.h
	by respective direct includes.
	(oval_plugin_launch): Replaced ntthread_t by int as it
	was handled as int already anyway.

	* openvassd/nes_plugins.c: Replaced use of includes.h
	by respective direct includes.

	* openvassd/nasl_plugins.c: Replaced use of includes.h
	by respective direct includes.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/save_kb.c (diff_scan, diff_scan_enable): Removed
	as these functions are never used and differntial computation
	do not belong to the Scanner anyway.

	* openvassd/save_kb.h: Removed protos accordingly.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/pluginlaunch.c: Replaced use of includes.h
	by respective direct includes.

	* openvassd/pluginload.c: Replaced use of includes.h
	by respective direct includes.

	* openvassd/plugs_hash.c: Replaced use of includes.h
	by respective direct includes.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/ntp_11.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of EXIT()
	by exit().

	* openvassd/save_kb.c: Replaced use of includes.h
	by respective direct includes.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/preferences.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of DO_EXIT()
	by exit().

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/utils.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of EXIT()
	by exit().

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/otp_1_0.c: Remove use of includes.h as it was
	not necessary.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/hosts.c: Replaced use of includes.h
	by respective direct includes.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/users.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of EXIT()
	by exit().

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/auth.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of EXIT()
	by exit().

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/locks.c: Replaced use of includes.h
	by respective direct includes.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/log.c: Replaced use of includes.h
	by respective direct includes.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/rules.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of EXIT()
	by exit().

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/comm.c: Removed uselsess defines of FALSE and TRUE.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/comm.c: Replaced use of includes.h
	by respective direct includes. Replaced occurences of EXIT()
	by exit().

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/parser.c: Removed TODO as it refers to
	openvas-client which is not relevant anymore in this case.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/parser.c: Replaced use of includes.h
	by respective direct includes.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/pluginscheduler.c (scheduler_plugin_score,
	scheduler_plugin_best_score): Removed functions that
	were disabled and marked as broken anyway.

2011-01-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/pluginscheduler.c: Replaced use of includes.h
	by respective direct includes.

2010-12-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/find_service/find_service.c: Made several functions
	static. These are not needed externally.

2010-12-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/find_service/find_service.c,
	cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c: Replaced
	use of includes.h by respective direct includes.

	* cnvts/synscan/synscan.c: Replaced use of includes.h by
	respective direct includes. Also removed inclusion of
	the openvastcp.h which is only relevant for absence
	of netinet.

	* cnvts/synscan/openvastcp.h, cnvts/synscan/openvasicmp.h,
	cnvts/synscan/openvasip.h, cnvts/synscan/openvasudp.h,
	cnvts/synscan/openvasraw.h: Removed. We assume we have
	have netinet.

	* MANIFEST: Updated.

2010-12-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* include/config.h.in: Remove long obsolete DEFAULT_PORT.

2010-12-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/openvassd.c (main): Adapted --version output to
	comply with GNU Coding Standards
	(http://www.gnu.org/prep/standards/standards.html#g_t_002d_002dversion)

2010-12-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/openvassd.c (main): Improved description text.

2010-12-28  Michael Wiegand <michael.wiegand@greenbone.net>

	Split README and INSTALL documentation to be consistent with other
	modules and to conform to the GNU Coding Standards recommendations.

	* README: Moved content regarding installation and configuration to
	new INSTALL file.

	* INSTALL: New file containing installation and configuration hints.

	* MANIFEST: Updated to include INSTALL.

2010-12-20  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/ntp_11.c (ntp_11_parse_input): Fix calls to
	hosts_pause_all and hosts_resume_all to match their prototypes.
	Discovered by Stephan Kleine.

2010-12-20  Michael Wiegand <michael.wiegand@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.2.0.rc2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-12-20  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.2+rc1 release.

	* VERSION: Set to 3.2.0.rc1.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2010-12-20  Michael Wiegand <michael.wiegand@greenbone.net>

	* README: Updated.

2010-12-17  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/openvassd.c (main): Default to listening on IPv4
	consistently if no other address is given instead of depending on
	whether the system has IPv6 capabilities or not.

2010-12-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Address compiler warnings discovered with hardening flags on gcc 4.4.
	Make hardening flags default.

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c
	(read_sysctl_maxsysfd): Check return value of fscanf.

	* configure.in: Add hardening flags to default flags.

	* configure: Regenerated.

	* openvassd/locks.c (file_lock, file_locked): Check return values of
	calls to write and read.

	* openvassd/nasl_plugins.c (nasl_thread): Catch result of call to
	nice. Added todo for checking the return value.

	* openvassd/nes_plugins.c (nes_thread): Catch result of call to nice.
	Added todo for checking the return value.

	* openvassd/openvassd.c (scanner_thread): Catch result of call to
	nice. Added todo for checking the return value.

	* openvassd/save_kb.c (save_kb_load_kb): Check return value of call to
	fgets.

2010-12-10  Michael Wiegand <michael.wiegand@greenbone.net>

	Stop logging debug messages during the handling of shared sockets
	unless DEBUG is defined.

	* openvassd/shared_socket.c (openvassd_shared_socket_register,
	openvassd_shared_socket_acquire, openvassd_shared_socket_release,
	shared_socket_cleanup_process): Stop shared_socket.c from being too
	verbose by wrapping debugging output in an #ifdef DEBUG.

	* openvassd/pluginlaunch.c (read_running_processes): Only log debug
	message if DEBUG is defined.

2010-12-06  Michael Wiegand <michael.wiegand@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.2.0.beta3.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-12-06  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.2+beta2 release.

	* VERSION: Set to 3.2.0.beta2.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2010-12-03  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/attack.c (init_host_kb): Initialize host_network_results
	as suggested by Matthew Mundell.

2010-12-02  Matthew Mundell <matthew.mundell@intevation.de>

	Adjust the restriction on client side rules: instead of always refusing to
	add any client side reject rules, accept any client side rules but only
	when the user is already allowed to scan all hosts.

	* openvassd/ntp_11.c (ntp_11_rules): Forbid client side rules when there
	are any server side rules besides for "default accept".

	* openvassd/rules.c (rules_add): Allow addition of accept rules when
	username is given.

2010-11-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Addressed 64 bit compiler warnings.

	* cnvts/find_service/find_service.c (mark_unknown_svc, plugin_do_run):
	Use GSIZE_TO_POINTER consistently instead casts to (void *).

	* openvassd/openvassd.c (scanner_thread): Use size_t for sizeof return
	value.

2010-11-18  Michael Wiegand <michael.wiegand@greenbone.net>

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c: Added include for
	openvas/misc/services.h.
	(std_port): Removed now superfluous declaration of
	openvas_get_svc_name.

2010-11-18  Michael Wiegand <michael.wiegand@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.2.0.beta2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-11-18  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.2+beta1 release.

	* VERSION: Set to 3.2.0.beta1.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

	* configure.in: Set required openvas-libraries version to 4.0.0.

	* configure: Regenerated.

	* openvassd/openvassd.c (main): Display OPENVAS_FULL_VERSION instead
	of OPENVAS_VERSION in -V and -d.

2010-11-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Replace plugin_ calls by using nvti directly.

	* openvassd/oval_plugins.c (oval_plugin_t): Removed because
	this struct is not required anymore (the nvti carries all of it).
	(current_plugin): now a nvti_t instead of oval_plugin_t.
	(start_element, text, oval_plugin_add): Handle nvti object now.
	Replace plugin_ calls by repsective nvti_ functions.

2010-11-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/attack.c (attack_network): Remove stray log message. Don't
	try to add target to the arglist if they are not set.

2010-11-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION: Updated from 3.1.2.SVN to 3.2.0.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-11-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/find_service/find_service.c,
	cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c,
	cnvts/synscan/synscan.c, openvassd/nasl_plugins.c,
	openvassd/comm.h, openvassd/utils.c, openvassd/otp_1_0.c,
	openvassd/plugs_req.c, openvassd/preferences.c, openvassd/ntp_11.c,
	openvassd/utils.h, openvassd/plugs_req.h, openvassd/attack.c,
	openvassd/ntp_11.h, openvassd/save_kb.c, openvassd/shared_socket.c,
	openvassd/save_kb.h, openvassd/piic.c, openvassd/nes_plugins.c,
	openvassd/pluginlaunch.c, openvassd/plugs_hash.c,
	openvassd/pluginload.c, openvassd/hosts.c, openvassd/auth.c,
	openvassd/users.c, openvassd/oval_plugins.c, openvassd/openvassd.c,
	openvassd/pluginload.h, openvassd/users.h, openvassd/locks.c,
	openvassd/rules.c, openvassd/comm.c, openvassd/parser.c,
	openvassd/pluginscheduler.c: Adjusted include paths for header
	files of libopenvas_misc.

2010-11-09  Michael Wiegand <michael.wiegand@greenbone.net>

	Added support for network level scans as described in OpenVAS Change
	Request #49 (see http://www.openvas.org/openvas-cr-49.html).

	* openvassd/preferences.c (preferences_network_scan): New function to
	return the value of the network_scan preference as int.

	* openvassd/preferences.h: Updated.

	* openvassd/pluginscheduler.c (plugins_scheduler_init): Changed
	function to accept an only_network switch. Remove NVTs in
	ACT_GATHER_INFO and up from the schedule if only_network is set.

	* openvassd/pluginscheduler.h: Updated.

	* openvassd/save_kb.c (save_kb): Ensure the KB is saved during a
	network level scan so we can us it later.

	* openvassd/attack.c (launch_plugin): Write to the network KB if we
	are scanning on the network level.
	(init_host_kb): If we are in the network scan phase, return a new
	network KB. If we have completed the network scan, get the relevant
	items from the network KB and use them in the host KB.
	(attack_host): Close the correct KB when an attack has finished.
	(attack_start): Check preferences to see if a network level scan has
	been requested and make the necessary preparations if this is the
	case.

2010-10-29  Michael Wiegand <michael.wiegand@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.1.2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-10-29  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.1.1 release.

	* VERSION: Set to 3.1.1.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2010-10-29  Michael Wiegand <michael.wiegand@greenbone.net>

	* doc/openvas-mkrand.1: Removed obsolete man page.

2010-10-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* ssl/, ssl/openvas-mkrand.c, ssl/Makefile: Removed.

	* MANIFEST, COPYING: Removed file entries accordingly.

	* Makefile: Removed handling of ssl mkrand module.

	* tools/openvas-mkcert.in: Exit with error when no suitable
	random source is found.

2010-09-29  Michael Wiegand <michael.wiegand@greenbone.net>

	* doc/openvassd.8.in: Fixed typos as suggested by Trent W. Buck.

2010-09-05 Thomas Reinke <reinke@securityspace.com>

	* Removed FIXME comment.  Rational: The preferences,
	despite being static, cannot be overwritten by another
	client beginning another scan, because each client is
	handled by a separate, forked, task, each with its
	own copy of memory.

2010-08-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* MANIFEST: Updated.

2010-08-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* COPYING: New. A summary of the licenses for each file.

2010-08-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* COPYING.GPLv2: New. Former COPYING.

	* COPYING: Removed. Renamed to COPYING.GPLv2.

2010-08-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/synscan/synscan.c: Added missing header with license
	and copyright. This file originates from the -plugins module
	and includes GPLv2 headers. It was and is linking GPLed nasl.
	So, the conservative assumption is GPLv2 (without the "or any
	later version" clause).

2010-08-12  Michael Meyer <michael.meyer@greenbone.net>

	* tools/openvas-mkcert-client.in:
	Bugfix (line 461: [: too many arguments).

2010-08-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* tools/README, tools/README_TOOLS: Moved, such that doxygen will
	include the correct README in the main page.

	* MANIFEST: Updated entry.

2010-07-26  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* openvassd/preferences.c: Resolved K&R function declarations.
	(preferences_get_string): Minor doc added.

2010-07-14  Michael Wiegand <michael.wiegand@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.1.1.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-07-14  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.1.0 release.

	* VERSION: Set to 3.1.0.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2010-07-05  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/openvassd.c (main): Remove superfluous libnasl version
	from --dump-cfg output.

2010-07-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/pluginscheduler.c (hash_fill_deps): Remove overly verbose
	log message when looking for dependencies.

2010-07-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.1.0.rc4.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-07-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.1.0.rc3 release.

	* VERSION: Set to 3.1.0.rc3.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2010-06-30  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/users.c (check_user): Finally remove legacy support for
	passwords stored in plaintext.

2010-06-28  Michael Wiegand <michael.wiegand@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.1.0.rc3.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-06-28  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.1.0.rc2 release.

	* VERSION: Set to 3.1.0.rc2.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2010-06-25  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/nasl_plugins.c (nasl_plugin_add): Check the modification
	time of the file before trying to cache a NASL script and fix it if it
	is greater than the current system time. Resolves the "unable to load
	plugins from the future" issue.

2010-06-25  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/attack.c (attack_init_hostinfos_vhosts): New. Initializes
	a hostinfos arglist with vhost values as well.
	(init_host_kb): Added vhosts parameter to function; now puts vhosts in
	the initial KB for this host if they are supplied.
	(attack_host): Hand hostinfos to init_host_kb.
	(attack_start): Put vhosts in hostinfos if both vhosts and vhosts_ip
	are set and if vhosts_ip matches the IP we are supposed to scan.

2010-06-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/preferences.c (preferences_drop_privileges): Removed stray
	debug message.

2010-06-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/nes_plugins.c (nes_thread): Attempt to drop privileges
	before executing the NES script.

2010-06-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/nasl_plugins.c (nasl_thread): Attempt to drop privileges
	before executing the NASL script.

2010-06-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/preferences.c (preferences_new): Add default value and
	comment for new preference "drop_privileges".
	(preferences_drop_privileges): New. Handles the new preference
	"drop_privileges".

	* openvassd/preferences.h: Updated.

2010-06-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/oval_plugins.c (drop_privileges): Renamed function to
	oval_drop_privileges to avoid namespace collision with function
	provided by openvas-libraries.

2010-06-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/greenbone-nvt-sync: Redirect error messages to stderr or log
	instead of writing them to stdout. Add --verbose flag. Add --nvt-dir
	flag. Check for openvassd binary in selftest. Reworked flow and
	command line parsing.

	* tools/openvas-nvt-sync.in: Make selftest work. Add --nvt-dir flag.
	Reworked flow and command line parsing.

2010-06-01  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/openvas-mkcert-client.in: Create the openvas users directory
	if installing the new user is requested and the directory does not
	exist.

2010-05-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* openvassd/ntp_11.c (files_add_translation): Adressed compiler
	warning, made content parameter not const (a reference is put in the
	hashtable, data might get manipulated or freed from somewhere else).

2010-05-20  Michael Wiegand <michael.wiegand@greenbone.net>

	* openvassd/ntp_11.c (files_add_size_translation): Removed stray debug
	message.

2010-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.1.0.rc2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the openvas-scanner 3.1.0.rc1 release.

	* VERSION: Set to 3.1.0.rc1.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2010-05-19  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* README: Added hint that openvas-scanner is an evolution of
	openvas-server. Corrected dependency statement.

2010-05-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Adding risk_factor tags to CNVTs.

	* cnvts/find_service/find_service.c (plugin_init): Set risk_factor.

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c (plugin_init): Set
	risk_factor.

	* cnvts/synscan/synscan.c (plugin_init): Set risk_factor.

2010-05-11  Michael Wiegand <michael.wiegand@greenbone.net>

	Changed preference file infrastructure to handle file uploads stored
	in memory instead of on disk. Part of OpenVAS Change Request #47
	(http://www.openvas.org/openvas-cr-47.html).

	* openvassd/utils.c (temp_file_name): Removed, function was obsoleted
	by the implementation of CR #47 and used nowhere else.

	* openvassd/utils.h: Updated.

	* openvassd/ntp_11.c (files_add_translation): This function now stores
	the contents of the uploaded file instead of the server side file
	name. Updated comments and variable names as well to reflect the
	change.
	(files_add_size_translation): New. Stores the size of the uploaded
	file so that it is available later to NASL functions.
	(build_global_host_sshlogins_map): Updated to read the mapping from a
	buffer instead of from a file.
	(build_global_sshlogin_info_map): Updated to read the mapping from a
	buffer instead of from a file.
	(ntp_11_recv_file): Read uploaded file into memory instead of writing
	it to a file.

	* openvassd/attack.c (fill_host_kb_ssh_credentials): Get credentials
	directly from memory instead of from a file.
	(unlink_name_mapped_file): Removed. Replaced by free_uploaded_file.
	(free_uploaded_file): New.

2010-04-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removed the CNVT "ssl_cipher" which is being replaced
	by the NASL implementation "secpod_ssl_ciphers.nasl".

	* cnvts/ssl_ciphers/, cnvts/ssl_ciphers/ssl_ciphers.c,
	cnvts/ssl_ciphers/Makefile: Removed.

	* MANIFEST: Updated.

2010-04-19  Michael Wiegand <michael.wiegand@greenbone.net>

	* tools/openvas-mkcert-client.in: Added switch to automatically
	install generated certificates for use with the openvas-manager.

2010-04-13  Michael Wiegand <michael.wiegand@intevation.de>

	* tools/greenbone-nvt-sync: Increase VERSION to reflect the changes
	made yesterday.

2010-04-13  Geoff Galitz <geoff@eifel-consulting.eu>

	* openvassd/attack.c: changed SSH-DEBUG message to not include
	references directly to LSC checks.  This is to avoid confusion
	between credentials debugging and LSC troubleshooting.

2010-04-12  Michael Wiegand <michael.wiegand@intevation.de>

	* tools/greenbone-nvt-sync: Removed unnecessary and misleading message
	when the log file could not be accessed. Changed behaviour to log to
	stderr instead of stdout when logging to a file is not possible.

2010-04-08  Matthew Mundell <matthew.mundell@intevation.de>

	File missing from 2010-03-11 commit.

	* openvassd/hosts.c (hosts_pause_all, hosts_resume_all): New functions.
	Send pause and resume signal to host process.
	(hosts_read_client): Pause or resume if client gave associated command.

2010-04-06  Michael Wiegand <michael.wiegand@intevation.de>

	* tools/openvas-nvt-sync.in: Split showing of description in two
	separate case for interactive and API use to make description in GSA
	look better.

2010-04-06  Michael Wiegand <michael.wiegand@intevation.de>

	* tools/greenbone-nvt-sync: Added support for retrieving the version
	of the NVT collection. Removed support for 2.0 infrastructures, tidied
	up parameter handling and function definitions, added check for
	subscription file to self test.

2010-03-11  Matthew Mundell <matthew.mundell@intevation.de>

	Add soft pausing of scans.  Implementation of Change Request #45:
	OpenVAS-Scanner: add pausing of scans,
	http://www.openvas.org/openvas-cr-44.html.

	* openvassd/otp_1_0.h (client_request_t): Add CREQ_PAUSE_WHOLE_TEST and
	CREQ_RESUME_WHOLE_TEST.

	* openvassd/otp_1_0.c (otp_1_0_get_client_request): Add PAUSE_WHOLE_TEST
	and RESUME_WHOLE_TEST commands.

	* openvassd/ntp_11.h (NTP_PAUSE_WHOLE_TEST, NTP_RESUME_WHOLE_TEST): New
	defines.

	* openvassd/ntp_11.c (ntp_11_parse_input): Add CREQ_PAUSE_WHOLE_TEST and
	CREQ_RESUME_WHOLE_TEST handling.

	* openvassd/attack.c (pause_whole_test): New variable.
	(attack_handle_sigusr1, attack_handle_sigusr2): New functions.  Set and
	clear pause_whole_test.
	(attack_host): Check pause_whole_test between plugins and pause if set.
	(attack_start): Set attack_handle_sigusr1 and attack_handle_sigusr2 as
	SIGUSR1 and SIGUSR2 handlers.

	* openvassd/hosts.c (hosts_pause_all, hosts_resume_all): New functions.
	Send pause and resume signal to host process.
	(hosts_read_client): Pause or resume if client gave associated command.

	* openvassd/hosts.h: Add headers accordingly.

2010-04-01  Michael Wiegand <michael.wiegand@intevation.de>

	* tools/openvas-nvt-sync.in: Added support for retrieving the version
	of the NVT collection.

2010-03-31  Matthew Mundell <matthew.mundell@intevation.de>

	* openvassd/nasl_plugins.c, openvassd/utils.c, openvassd/plugs_req.c,
	openvassd/preferences.c, openvassd/ntp_11.c, openvassd/attack.c,
	openvassd/save_kb.c, openvassd/shared_socket.c, openvassd/pluginlaunch.c,
	openvassd/oval_plugins.c, openvassd/parser.c: Flush trailing whitespace.

2010-03-30  Matthew Mundell <matthew.mundell@intevation.de>

	* openvassd/comm.h, openvassd/utils.c, openvassd/parser.h,
	openvassd/otp_1_0.c, openvassd/plugs_req.c, openvassd/preferences.c,
	openvassd/ntp_11.c, openvassd/pluginscheduler.h, openvassd/utils.h,
	openvassd/processes.c, openvassd/otp_1_0.h, openvassd/plugs_req.h,
	openvassd/preferences.h, openvassd/ntp_11.h, openvassd/attack.c,
	openvassd/save_kb.c, openvassd/processes.h, openvassd/sighand.c,
	openvassd/shared_socket.c, openvassd/save_kb.h, openvassd/sighand.h,
	openvassd/shared_socket.h, openvassd/piic.c, openvassd/nes_plugins.c,
	openvassd/pluginlaunch.c, openvassd/piic.h, openvassd/plugs_hash.c,
	openvassd/pluginload.c, openvassd/pluginlaunch.h, openvassd/hosts.c,
	openvassd/auth.c, openvassd/users.c, openvassd/oval_plugins.c,
	openvassd/openvassd.c, openvassd/plugs_hash.h, openvassd/pluginload.h,
	openvassd/hosts.h, openvassd/auth.h, openvassd/users.h, openvassd/locks.c,
	openvassd/locks.h, openvassd/log.c, openvassd/log.h, openvassd/rules.c,
	openvassd/comm.c, openvassd/parser.c, openvassd/pluginscheduler.c,
	openvassd/nasl_plugins.c, openvassd/rules.h: Format according to coding
	style.  Command was 'indent --no-tabs --ignore-newlines -l 80 *.c *.h'.

2010-03-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removed the superfuous handling of the bin/ directory.
	This handling only added confusion, no benefit.

	*  bin/.create, bin/: Removed.

	* cnvts/find_service/Makefile, cnvts/openvas_tcp_scanner/Makefile,
	cnvts/ssl_ciphers/Makefile, cnvts/synscan/Makefile: Keep .nes file
	in the respective directory.

	* cnvts/install_plug: Remove copying of .nes to a "bin/" directory.

	* Makefile: Removed handling of bin/ directory.

2010-03-23  Michael Meyer <michael.meyer@intevation.de>

	* tools/openvas-nvt-sync.in:
	Added "-t" to mktemp.

2010-03-23  Michael Meyer <michael.meyer@intevation.de>

	* tools/openvas-nvt-sync.in:
	Bugfix in "mktemp" (too few X's in template).

2010-03-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION: Set to 3.1.0.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-03-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/session_saving.txt: Removed.

	* MANIFEST: Updated.

2010-03-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	This is the second patch to remove the "Session Saving"
	feature. This corresponds to Change Request #46,
	http://www.openvas.org/openvas-cr-46.html

	This patch removes the conditional code paths for
	"ENABLE_SAVE_TESTS" which are not used anyway since
	the first patch.

	* openvassd/comm.c (comm_send_preferences): Don't send
	"ntp_save_sessions" as preference anymore.

	* openvassd/ntp_11.c: Removed inclusion of save_tests.h (it
	was not ifdef-protected).
	(extract_session_key_from_session_msg, ntp_11_delete_session,
	ntp_11_restore_session, ntp_11_list_sessions): Removed.
	(ntp_11_parse_input): Removed handling of Session Saving commands
	LIST, DELETE and RESTORE.

	* openvassd/openvassd.c (scanner_thread): Remove handling of
	RESTORE-SESSION.

	* openvassd/preferences.h: Removed protos for preferences_save_session
	and preferences_save_empty_sessions.

	* openvassd/attack.c, openvassd/utils.c, openvassd/hosts.c: Removed
	inclusion of save_tests.h (it was not ifdef-protected).

	* openvassd/save_tests.c, openvassd/save_tests.h: Removed.

	* openvassd/Makefile: Removedhandling of module"save_tests".

	* openvassd/save_kb.c: Removed a TODO entry concerning save_tests.c.

	* MANIFEST: Updated.

2010-03-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	This is the first patch to remove the "Session Saving"
	feature. This corresponds to Change Request #46,
	http://www.openvas.org/openvas-cr-46.html

	Deactivating feature "ENABLE_SAVE_TESTS". Some code
	paths were not covered by this conditional and thus
	were cleaned up manually.

	* include/config.h.in: Removed macro ENABLE_SAVE_TESTS
	and thus deactivated this feature.

	* openvassd/attack.c (attack_network): Removed handling
	of "restoring" and "save_session".

	* openvassd/hosts.c (forward, host_rm): Removed call of deactivated
	function. This also allows to remove the retrieval and
	use of the preferences structure.

	* openvassd/otp_1_0.h (client_request_t): Remove the CREQ_SESSION*
	items.

	* openvassd/otp_1_0.c (otp_1_0_get_client_request): Remove
	identification and handling of OTP commands "SESSIONS_LIST",
	"SESSION_DELETE", "SESSION_RESTORE".

2010-03-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.0.3.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Increased PROJECT_NUMBER accordingly.

2010-03-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the openvas-scanner 3.0.2 release.

	* VERSION: Set to 3.0.2.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2010-03-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* tools/openvas-nvt-sync.in: Use mktemp when TMPDIR is
	undefined to prevent using /tmp directly. Since filenames
	created by the script are predictable using /tmp could lead to a race
	condition and an attack to the user running the script (typically root, since
	it needs to change /usr or /var).

2010-03-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* Makefile: Make_world does not clean, remove the binary
	files in bin/ manually.

2010-03-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* tools/greenbone-nvt-sync: New.

	* Makefile: Added handling for additional sync method.

	* MANIFEST: Updated.

2010-03-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* configure: Updated.

2010-03-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvas-nvt-sync.in, tools/openvas-nvt-sync.in:
	Moved to tools/.

	* configure.in, Makefile, MANIFEST: Adapted accordingly.

2010-03-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvas-mkcert-client.in, tools/openvas-mkcert-client.in:
	Moved to tools/.

	* configure.in, Makefile, MANIFEST: Adapted accordingly.

2010-03-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvas-mkcert.in, tools/openvas-mkcert.in: Moved to tools/.

	* configure.in, Makefile, MANIFEST: Adapted accordingly.

2010-03-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* Makefile: Removed removal of non-existing openvas-install-cert.

2010-03-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvas-rmuser.in, tools/openvas-rmuser.in: Moved to tools/.

	* configure.in, Makefile, MANIFEST: Adapted accordingly.

2010-03-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvas-adduser.in, tools/openvas-adduser.in: Moved to tools/.

	* configure.in, Makefile, MANIFEST: Adapted accordingly.

2010-03-12  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-adduser.in: Convert dname to GnuTLS format.

2010-03-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Adding a tools directory where to collect assisting scripts.

	* tools/, tools/README: New.

	* MANIFEST: Updated.

2010-03-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/save_kb.c, openvassd/preferences.h,
	include/config.h.in: Removed conditional "ENABLE_SAVE_KB".
	This is not an experimental feature anymore. It has
	become an intergral part of the scanner since a long
	time and is a valuable feature for debugging purposes.

2010-03-11  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-mkcert-client.in: Cleaned up bashisms in dname conversion.

2010-03-10  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-mkcert-client.in: Cleaned and reworked script for generating
	OpenVAS client certificates. Now works with current openvas-scanner
	and allows to create certificates non-interactively.

2010-03-09  Michael Meyer <michael.meyer@intevation.de>

	* cnvts/find_service/find_service.c:
	Re-enabled "mark_unknown_svc()". This function was removed in Rev
	38. Nobody knows why. This function is very important for
	find_service*.nasl (and a few others) because they all based
	upon "Services/unknown" which are stored in KB by
	mark_unknown_svc().

2010-03-01 Stephan Kleine

	* cnvts/ssl_ciphers/ssl_ciphers.c: Changed return type of report_cat
	from int to void to fix a no-return-in-nonvoid-function error.

2010-02-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/ntp_11.c (files_add_translation): Corrected parameter
	documentation.

2010-02-12  Michael Wiegand <michael.wiegand@intevation.de>

	* openvassd/nasl_plugins.c: Removed obsolete reference from comment.

2010-02-11  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-nvt-sync.in: Removed superfluous outputs which broke the
	compatibility with openvas-administrator.

2010-02-09  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvas-adduser.in: exit 0 if successfull, exit 1 if no input to user
	name/login is given.

2010-02-09  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvas-adduser.in: Cosmetics.

2010-02-04  Michael Wiegand <michael.wiegand@intevation.de>

	* openvassd/plugs_hash.c: Removed superfluous include of users.h.

2010-02-04  Michael Wiegand <michael.wiegand@intevation.de>

	* openvassd/pluginload.c: Removed superfluous include of users.h.

2010-01-26  Michael Wiegand <michael.wiegand@intevation.de>

	Post-release version bump.

	* VERSION: Set to 3.0.2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2010-01-26  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-scanner 3.0.1 release.

	* VERSION: Set to 3.0.1.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2010-01-26  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvas-nvt-sync.in: Flush trailing whitespaces, minor reformatting
	for more consistency.

2010-01-26  Vlatko Kosturjak <kost@linux.hr>

	* openvas-nvt-sync.in: quick merge of old script which had support
	for OpenVAS administrator and new script. In short, best of both
	worlds (scripts).

2010-01-26  Vlatko Kosturjak <kost@linux.hr>

	* openvas-nvt-sync.in: completely new version of openvas-nvt-sync,
	it passed quite a while on mailing list and nobody reported
	any serious bug (except cosmetic changes which can be contributed
	now to SVN).

2010-01-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Added code for a very basic standalone synscanner based on the cnvt to
	ease debugging (e.g. IPv6 might not yet work).

	* cnvts/synscan/synscan.c: Remove undef of DEBUG macro.
	[DEBUG] (openbpf): Be very verbose.
	(scan): Instead of accessing values in arglists, accept these values as
	parameters, slighty more verbose ifdef DEBUG.
	(plugin_run): Find and pass new parameters for scan().
	[STANDALONE] (main): New. Main for the standalone synscanner.

2010-01-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* cnvts/synscan/synscan.c: More cosmetics and debug output (conditional
	on DEBUG macro).

2010-01-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c, openvassd/hosts.c:
	Flush trailing white
	spaces, minor other cosmetic changes.

	* openvassd/attack.c, openvassd/attack.h: Cosmetics, docs.

2010-01-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/synscan/synscan.c (rawsocket): Fixed typos in
	error strings.

2010-01-22  Matthew Mundell <matthew.mundell@intevation.de>

	* openvassd/users.c [DEBUG_RULES]: Print with log_write.
	(users_add_rule): Set the rule family.

	* openvassd/rules.c [DEBUG_RULES]: Print with log_write.
	(rules_dump): Add ip4 or ip6 on front of line.

	* openvassd/openvassd.c (scanner_thread) [DEBUG_RULES]: Print with
	log_write.

2010-01-21  Matthew Mundell <matthew.mundell@intevation.de>

	* openvassd/openvassd.c (scanner_thread): Format more consistently.

2010-01-21  Matthew Mundell <matthew.mundell@intevation.de>

	* openvassd/users.c, openvassd/rules.c, openvassd/openvassd.c: Flush
	trailing whitespace.

2010-01-20  Michael Wiegand <michael.wiegand@intevation.de>

	Improved error handling in certificate authentication.

	* openvassd/openvassd.c (scanner_thread): Added improved error detection
	and handling as suggested by Stefan Bhler.

2010-01-19  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* cnvts/synscan/synscan.c: Cosmetics, doc.

2010-01-18  Michael Wiegand <michael.wiegand@intevation.de>

	Re-enabling certificate authentication.

	* openvassd/openvassd.c (scanner_thread): Added code for retrieving the
	X.509 DName from a session certificate so that the DName can be passed
	to auth_check_user(). Based on code suggested by Roman Imankulov.

2010-01-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* cnvts/synscan/synscan.c: Reformatting, added svn revision keyword
	property.

2009-12-18  Michael Wiegand <michael.wiegand@intevation.de>

	Post-release version bump.

	* VERSION: Set to 3.0.1.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-12-18  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-scanner 3.0.0 release.

	* VERSION: Set to 3.0.0.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2009-12-17  Michael Wiegand <michael.wiegand@intevation.de>

	* openvassd/preferences.c (preferences_new): Added group name so the
	openvassd.conf complies with the key file specification (see
	http://freedesktop.org/Standards/desktop-entry-spec).

2009-12-09  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/ntp_11.c: Cosmetics.

	* openvassd/utils.c (temp_file_name): Reformatted.

2009-12-07  Michael Wiegand <michael.wiegand@intevation.de>

	Post-release version bump.

	* VERSION: Set to 3.0.0.rc2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-12-07  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-scanner 3.0.0-rc1 release.

	* VERSION: Set to 3.0.0.rc1.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2009-12-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvas-nvt-sync.in: Added URL of feed home page.

2009-12-03  Chandrashekhar B <bchandra@secpod.com>

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c,
	cnvts/synscan/synscan.c: Fixed compiler warnings.

2009-12-03  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-nvt-sync.in: Added support for upcoming synchronization
	script API.

2009-12-02  Michael Wiegand <michael.wiegand@intevation.de>

	Made logging less verbose by wrapping a number of debugging messages in
	an #ifdef DEBUG.

	* openvassd/auth.c (auth_check_user): Only log successful logins when
	DEBUG is defined.

	* openvassd/comm.c (comm_init): Only log the protocol version requested
	by the client when DEBUG is defined.

	* openvassd/openvassd.c (main_loop): Only log debug messages about the
	connection when DEBUG is defined.

2009-11-30  Chandrashekhar B <bchandra@secpod.com>

	* cnvts/synscan/synscan.c (rawsocket): IPv6 enabling.
	(extractack): IPv6 enabling.
	(extractsport): IPv6 enabling.
	(issynack): IPv6 enabling.
	(scan): IPv6 enabling.
	(sendpacket): IPv6 enabling.
	(v6_openbpf): Added new.
	(v6_extracttcp): Added new.
	(mktcpv6): Added new.
	(v6_sendpacket): Added new.

	Coding by Srinivas NL <nl.srinivas@gmail.com> and Chandrashekhar B.

2009-11-25  Chandrashekhar B <bchandra@secpod.com>

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c: Fixed a possible
	overflow.

2009-11-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/attack.c, openvassd/plugs_req.c, openvassd/preferences.c,
	openvassd/processes.c, openvassd/processes.h, openvassd/sighand.c,
	openvassd/users.c, openvassd/auth.c: Minor cosmetics.
	openvassd/attack.c (attack_init_hostinfos): Removed not used local
	variable.

2009-11-23  Michael Wiegand <michael.wiegand@intevation.de>

	Post-release version bump.

	* VERSION: Set to 3.0.0.beta7.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-11-23  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-scanner 3.0.0-beta6 release.

	* VERSION: Set to 3.0.0.beta6.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2009-11-23  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Added check for pcap to configure. Thanks to  Stephan Kleine for
	spotting this issue. Closes bug #1192 (http://bugs.openvas.org/1192).

	* configure.in: Added check for pcap.

	* configure: Regenerated.

2009-11-23  Chandrashekhar B <bchandra@secpod.com>

	* openvassd/attack.c (attack_init_hostinfos): Call hg_get_name_from_ip()
	with the correct IP argument. Host name was resolving to a wrong random
	looking address. Fixed by Srinivas NL <nl.srinivas@gmail.com>.

2009-11-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvas-rmuser.in: Removed unused variables openvassd_users,
	openvassd, mandir, infodir, oldincludedir, includedir.

	* include/config.h.in (OPENVASSD_USERS): Removed macro.

	* openvassd/preferences.c (preferences_new): Removed creation
	of entry "users".

	* openvassd/comm.c (comm_send_preferences): Marked "users"
	as deprectated and added a more general TODO for similar cases.

2009-11-14  Srinivas NL <nl.srinivas@gmail.com>

	* openvassd/openvassd.c (convert_ip_addresses): Modified to handle
	both ipv4 and ipv6 addresses. It will parse values of -S option and
	return either a list of ipv4 or ipv6 addresses.

	* openvassd/openvassd.c (main): Calls convert_ip_addresses twice
	passing values of -S option to get lists of ipv4 and ipv6 addresses.

2009-11-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/pluginlaunch.c: Cosmetics and added TODO (and howto) about
	sending log messages in case of killing NVTs due to timeout.

2009-11-10  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Resolved typos lead to by Ryan Schmidt.

	* include/threadcompat.h: Replaced "recommand" by "recommend", added
	todo about duplicate code.

2009-11-10  Chandrashekhar B <bchandra@secpod.com>

	* openvassd/attack.c (attack_network): Use new
	functions from pcap to get MAC address and check
	whether target belongs to localnet.

	Coding by Srinivasa NL <nl.srinivas@gmail.com>.

2009-11-10  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/utils.c (temp_file_name): Doc, added comment about toctou
	race condition and why its not totally straight-forward to replace by
	glib functions.

2009-11-09  Michael Meyer <michael.meyer@intevation.de>

	* cnvts/find_service/find_service.c:
	Removed HAVE_SSL remains.

2009-10-26  Michael Wiegand <michael.wiegand@intevation.de>

	Post-release version bump.

	* VERSION: Set to 3.0.0.beta6.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-10-26  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-scanner 3.0.0-beta5 release.

	* VERSION: Set to 3.0.0.beta5.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2009-10-26  Michael Meyer <michael.meyer@intevation.de>

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c,
	cnvts/synscan/synscan.c:
	Added dependency ping_host.nasl.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/openvassd.c: Add missing include.

2009-10-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/openvassd.c (restart_openvassd, main): Use new
	pidfile management.

	* openvassd/sighand.c (sighandler): Use new pidfile management.

	* openvassd/utils.c (create_pid_file, delete_pid_file): Removed.

	* openvassd/utils.h: Removed protos accordingly.

2009-10-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/comm.c: replace ntp.h by otp.h.

2009-10-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removing remains of old ntp_caps.

	* openvassd/utils.c (plugins_set_ntp_caps): Removed.

	* openvassd/utils.h: Removed proto accordingly.

	* openvassd/openvassd.c (scanner_thread): Removed call to
	set global ntp_caps. Removed call of plugins_set_ntp_caps
	which initalized the plugins with the gobal ntp_caps.

	* openvassd/comm.c (comm_init): changed return value from
	ntp_caps to just int, specifiying the protocol version.

	* openvassd/comm.h: Adjusted proto accordingly.

	* openvassd/attack.c, openvassd/utils.c, openvassd/ntp_11.c:
	Removed unnecessary include of ntp.h.

2009-10-19  Michael Wiegand <michael.wiegand@intevation.de>

	Post-release version bump.

	* VERSION: Set to 3.0.0.beta5.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-10-19  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-scanner 3.0.0-beta4 release.

	* VERSION: Set to 3.0.0.beta4.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2009-10-14 Srinivas NL <nl.srinivas@gmail.com>

	* cnvts/synscan/synscan.c: Temporary fix to remove compilation
	warning. Will be fixed properly once pcap is modified to handle
	ipv6

2009-10-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/openvassd.c, openvassd/attack.c: Corrected includes.

2009-10-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/openvassd.c (scanner_thread): Add NULL initialization
	to get rid of compiler warning.

2009-10-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/plugs_hash.c (plugins_send_md5_byid): Renamed to
	plugins_send_md5. This removes the unnecessary layer. Now
	always send by oid.

2009-10-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/plugs_hash.c (plugins_send_md5_byname): Removed. This
	function is not used anyway. It uses names to identify NVTs which
	are not required to be unique. Instead, OID is used.

2009-10-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/openvassd.c: Added missing include. Resolves
	compiler warning.

2009-10-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/attack.c: Added missing include. Resolves compiler warning.

2009-10-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvassd/openvassd.c (scanner_thread): Removed handling
	of SSL version being set to "none". This does not make sense
	to handle. If none is specified, now the scanner will fall back
	to its default as done before for any unknown SSL identifier.

2009-10-13  Matthew Mundell <matthew.mundell@intevation.de>

	* openvassd/comm.c: Replace category name list with ACT_STRING_LIST_ALL.

2009-10-13  Matthew Mundell <matthew.mundell@intevation.de>

	* openvassd/comm.c, ChangeLog: Flush trailing whitespace.

2009-10-12  Michael Wiegand <michael.wiegand@intevation.de>

	* openvassd/openvassd.c (main): Made command line options more
	consistent with other modules and coding standards. Short option for
	--version is now -V (was -v).

2009-10-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvas-mkcert-client.in, openvas-mkcert.in: Changed Paris to Berlin
	for the default.

2009-10-08  Michael Wiegand <michael.wiegand@intevation.de>

	* openvassd/otp_1_0.c (otp_1_0_server_send_certificates): Added todo
	for segfault on nonexistent public key.

2009-10-06  Tim Brown <timb@openvas.org>

	* openvassd/utils.c: Fixed memory leak, typos and resource leak. Also added
	todo for TOCTOU race condition on temp_file_name() (details sent to
	openvas-devel@).

2009-10-06  Michael Wiegand <michael.wiegand@intevation.de>

	Post-release version bump.

	* VERSION: Set to 3.0.0.beta4.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-10-06  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-scanner 3.0.0-beta3 release.

	* VERSION: Set to 3.0.0.beta3

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2009-10-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Removed dependence on libopenvas.h.

	* cnvts/find_service/find_service.c: Added includes and defines that
	previously were in libopenvas.h.

	* openvassd/pluginload.h: Added function typedefs that were previously
	in libopenvas.h.

	* openvassd/nes_plugins.c, openvassd/openvassd.c,
	openvassd/oval_plugins.c, openvassd/utils.c: Removed libopenvas-include,
	added missing includes.

2009-10-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* cnvts/synscan/synscan.c, openvassd/save_tests.c,
	openvassd/nasl_plugins.c: Added missing includes.

2009-10-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/plugs_hash.c, openvassd/oval_plugins.c: Added includes.

	* ChangeLog: Corrected.

2009-10-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Towards removal of libopenvas.h.

	* openvassd/attack.c
	(attack_network): Removed unused variable.

	* cnvts/find_service/find_service.c, cnvts/openvas_tcp_scanner.c,
	cnvts/synscan/synscan.c, openvassd/save_kb.c, openvassd/save_tests.c:
	Cleaned up/added includes.

	* include/includes.h: Removed include of libopenvas.h and ntp.h.

	* openvassd/openvassd.c, openvassd/oval_plugins.c, openvassd/utils.c:
	Added include of libopenvas.h where not yet resolved.

	* openvassd/plugs_req.c: Added include.
	(requirements_common_ports): Corrected typo from last commit.

2009-10-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/pluginscheduler.c, openvassd/plugs_req.c,
	openvassd/save_kb.c, openvassd/save_tests.c, openvassd/utils.c,
	openvassd/piic.c: Cosmetics, doc, todos added.

	* ChangeLog: corrected with last entry.

2009-10-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Towards removal of libopenvas.h.

	* openvassd/utils.h, openvassd/users.c, openvassd/users.h,
	openvassd/shared_socket.c, openvassd/save_kb.h, openvassd/rules.c,
	openvassd/preferences.c, openvassd/plugs_req.h,, openvassd/plugs_hash.c,
	openvassd/pluginscheduler.h, openvassd/pluginload.h,
	openvassd/pluginload.c, openvassd/pluginlaunch.c, openvassd/parser.c,
	openvassd/ntp_11.h, openvassd/ntp_11.c, openvassd/nes_plugins.c,
	openvassd/nasl_plugins.c, openvassd/locks.c, openvassd/hosts.c,
	openvassd/comm.h, openvassd/comm.c, cnvts/ssl_ciphers/ssl_ciphers.c:
	Added/cleaned up includes.

2009-09-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.0.0.beta3.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-09-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Last minute fix.

	* CHANGES: Fix a broken sentence.

2009-09-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the openvas-scanner 3.0.0-beta2 release.

	* VERSION: Set to 3.0.0.beta2

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2009-09-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Remove usages of harglist from scanner.

	* include/includes.h, openvassd/openvassd.c: Removed include of
	harglists.h

	* openvassd/attack.c (fill_host_kb_ssh_credentials)
	(attack_network): Use GHashTable instead of harglist.
	(unlink_name_mapped_file): New, used as callback in a
	g_hash_table_foreach.

	* openvassd/ntp_11.c (files_add_translation): Use GHashTable instead
	of harglist.

2009-09-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/comm.c, openvassd/nasl_plugins.c, openvassd/otp_1_0.c,
	openvassd/oval_plugins.c, openvassd/pluginload.c: Adjusted includes
	(openvas-libraries/nasl headers get installed to openvas/nasl now.)

2009-09-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/ntp_11.c (files_add_translation): Reformatted.

	* openvassd/attack.c: Minor cosmetics.

2009-09-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/ntp_11.c: Cosmetics, replaced K&R function decls.

2009-09-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/openvassd.c: Adjusted includes (openvas-libraries/nasl
	headers get installed to openvas/nasl now.)

2009-09-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/attack.c, openvassd/openvassd.c, openvassd/preferences.c:
	Adjusted includes (openvas-libraries/hg headers get installed to
	openvas/hg now.)

2009-09-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/attack.c (attack_network): Replaced harglist by GHashTable.

	* openvassd/save_tests.c (save_tests_playback,
	save_tests_setup_playback): Replaced harglst by GHashTable.

	* openvassd/save_tests.h (save_tests_playback): Changed signature, take
	GHashTable instead of harglst.

2009-09-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/otp_1_0.c: Minor cosmetics.

2009-09-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/otp_1_0.c: Adjusted includes.
	(otp_1_0_server_send_certificates): Switch from
	openvas-libraries/base/openvas_certificate to
	openvas-libraries/base/certificate.

2009-09-24  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* configure.in: Consider recent name change from libopenvasmisc
	to libopenvas_misc. Also, libnasl is not separate anymore.

	* openvas.tmpl.in: Removed LIBNASL specific elements.

	* configure: Updated.

2009-09-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.0.0.beta2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-09-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the openvas-scanner 3.0.0-beta1 release.

	* VERSION: Set to 3.0.0.beta1

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2009-09-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* MANIFEST: Added missing file.

2009-09-23  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvassd/openvasd.c: (re)moved.

	* openvassd/openvassd.c: Moved from openvassd/openvasd.c.

	* openvasd/Makefile, MANIFEST: Adjusted.

	* openvassd/attack.c, openvassd/parser.c, openvassd/pluginlaunch.c,
	openvassd/processes.c: Adjusted comments.

	* doc/Doxyfile, doc/Doxyfile_full: Adjusted paths.

	* doc/session_saving.txt, doc/openvas-mkcert-client.1: Adjusted

2009-09-23  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Moved folder openvasd to openvassd.

	* openvasd, openvassd: Moved folder from openvasd to openvassd.

	* Makefile, MANIFEST: Adjusted paths.

2009-09-23  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* doc/openvassd.8.in: Replaced nessus by openvas.

	* configure.in: Corrected check for pthreads_enabled.

	* configure: Regenerated.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* packaging/fedora/openvas-server-1.0.0-1.fc8.openvas.spec,
	packaging/fedora/openvas-server-1.0.0-Makefile.diff, packaging/fedora/,
	packaging/opensuse/openvas-server-1.0.0-1.suse102.openvas.spec,
	packaging/opensuse/openvas-server-1.0.0-Makefile.diff,
	packaging/opensuse/, packaging/debian/, packaging/: Removed. These
	files for packagig are very outdated. The packaging is now managed
	separately.

	* MANIFEST: Updated.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/openvasd.c, openvasd/otp_1_0.c, openvasd/otp_1_0.h,
	openvasd/oval_plugins.c: Copyright transfer from Intevation
	to Greenbone.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/TODO.txt: Added contents of toplevel TODO file.

	* TODO: Removed.

	* configure.in: Upgraded required openvas-libraries version to 3.0.0.
	Upgraded required glib from 2.6 to 2.12.

	* configure: Updated.

	* MANIFEST: Updated.

2009-09-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* configure.in: Removed seconf reference to openvassd-config.

	* configure: Regenerated.

	* ChangeLog: Fixed identity theft.

2009-09-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* configure.in: Removed reference to openvassd-config.

	* configure: Regenerated.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* Makefile: Don't install openvassd-config anymore.

	* openvassd-config.in: Removed. This is not necessary
	anymore because openvas-plugins does not need it and the
	sysconfdir is provided by the scanner via command line option.

	* MANIFEST: Updated.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/find_service/find_service.c (plugin_do_run): Adapted to API
	change (nessus_get_socket_from_connection ->
	openvas_get_socket_from_connection).

2009-09-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* Makefile: Renamed openvas-server to openvas-scanner.

	* openvasd/Makefile: Renamed openvasd to openvassd.

	* include/corevers.h.in: Adjusted to cover openvasd/openvassd change.

	* configure: Regenerated.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/openvas-nvt-sync.8: New. man page for the sync
	script. Written and contributed by Javier Fernndez-Sanguino Pea.

	* doc/openvassd-config.1: Removed. The corresponding is not
	part of this package anymore.

	* doc/kb_saving.txt: Removed. This information is part of the
	regular documentation since a long time.

	* Makefile: Don't install openvassd-config.8 anymore. Install
	openvas-nvt-sync.8.

	* doc/TODO.txt: Cleaned a little bit.

	* MANIFEST: Updated.

2009-09-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* configure.in, openvasd/save_tests.c, openvasd/pluginlaunch.c,
	openvasd/shared_socket.c, openvasd/users.c: Replaced occurances of
	openvasd by openvassd.

2009-09-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd-config.in, openvassd-config.in: Moved file.

	* doc/openvasd.8.in, doc/openvassd.8,in: Moved.

	* doc/openvasd-config.1, doc/openvassd-config.1: Moved.

	* doc/kb_saving.txt, doc/openvas-mkrand.1, doc/openvas-rmuser.8,
	doc/nsr_file_format.txt, doc/nbe_file_format.txt, doc/openvas-mkcert.8,
	doc/openvas-adduser.8, doc/openvassd.8.in: Replaced occurances of
	openvasd by openvassd.

2009-09-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	First steps of renaming openvasd to openvassd, openvas-server to
	openvas-scanner.

	* configure.in, Makefile, openvas-adduser.in, openvasd-config.in,
	openvas-mkcert-client.in, openvas-mkcert.in, openvas-nvt-sync.in,
	openvas-rmuser.in, openvas.tmpl.in, README, doc/Doxyfile,
	doc/Doxyfile_full, doc/kb_saving.txt, doc/openvasd.8.in,
	doc/openvas-mkcert.8, doc/openvas-mkrand.1, session_saving.txt: Renamed
	openvasd to openvassd, server to scanner.

	* openvasd/auth.c, openvasd/comm.c, openvasd/log.c, openvasd/openvasd.c
	openvasd/pluginscheduler.c, openvasd/preferences.c, openvasd/rules.c,
	openvasd/save_tests.c, openvasd/shared_socket.c, openvasd/users.c,
	openvasd/utils.c, cnvts/synscan/synscan.c, include/config.h.in: Renamed
	openvasd to openvassd in source, comments and output.

2009-09-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/utils.h, openvasd/users.h, openvasd/sighand.h,
	openvasd/processes.h, openvasd/preferences.h,
	openvasd/plugs_hash.h, openvasd/pluginload.h,
	openvasd/piic.h, openvasd/parser.h, openvasd/openvasd.c,
	openvasd/ntp_11.h, openvasd/log.h, openvasd/locks.h,
	openvasd/comm.h, openvasd/auth.h, openvasd/attack.h,
	cnvts/ssl_ciphers/ssl_ciphers.c,
	cnvts/find_service/find_service.c:
	Replaced "NESSUS" by "OPENVAS".

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c: Adjusted
	API calls due to name change nessus to openvas.

2009-09-18  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* MANIFEST: Updated as filenames were changed.

2009-09-18  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* cnvt/synscan/openvasicmp.h, cnvt/synscan/openvasip.h,
	cnvt/synscan/openvasraw.h, cnvt/synscan/openvastcp.h,
	cnvt/synscan/openvasudp.h: Adjusted include guards and includes to new
	filenames, added todos (code duplicate in openvas-libraries/nasl).

2009-09-18  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	First part of renaming files (nessus->openvas) in the synscan c-nvt.

	* cnvt/synscan/nessusicmp.h, cnvt/synscan/nessusip.h,
	cnvt/synscan/nessusraw.h, cnvt/synscan/nessustcp.h,
	cnvt/synscan/nessusudp.h, cnvt/synscan/openvasicmp.h,
	cnvt/synscan/openvasip.h, cnvt/synscan/openvasraw.h,
	cnvt/synscan/openvastcp.h, cnvt/synscan/openvasudp.h: Moved.

	* cnvt/synscan/synscan.c: Adjusted include.

2009-09-17  Chandrashekhar B <bchandra@secpod.com>

	These changes support kernels that might not have ipv6
	module loaded. Coding by Srinivasa NL <nl.srinivas@gmail.com>.

	* openvasd/openvasd.c (main): Initialize "ai" with saddr or s6addr
	to wild card address depending on ipv6 availablilty.
	(main_loop): wait for ipv4 only client or
	ipv4/ipv6 client depending on what address the server is bound to.

2009-09-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/sighand.h, openvasd/processes.c, openvasd/openvasd.c,
	openvasd/attack.c, openvasd/comm.c, openvasd/sighand.c,
	openvasd/utils.c, openvasd/hosts.c, openvasd/pluginlaunch.c,
	openvasd/save_kb.c, openvasd/parser.c: Replaced "nessus" by
	"openvas" in function names.

2009-09-16  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-mkcert.in: Replace usage of MD5 as certificate signature
	algorithm with SHA1.

2009-09-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvas-adduser.in, openvas-mkcert-client.in, openvas-mkcert.in,
	openvas-rmuser.in: Renamed text domain from nessus-scripts to
	openvas-scripts.

2009-09-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* doc/openvasd.8.in: Removed sections about non-implemented options,
	updated links to project information (removing the link a former
	existing mailing list overview page).

2009-09-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Changed default behavior: openvasd now by default runs in background.
	New option -f (--foreground) has to be specified to keep it in
	foreground.

	* openvasd/openvasd.c (main): Changed default behavior, openvasd now
	backgrounds by default.

	* doc/openvasd.8.in: Document change in manpage.

2009-09-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/openvasd.c: Cosmetics.

	* openvasd/openvasd.c (init_network): Print error message to stderr and
	not only to log if socket acquiration failed.

2009-09-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/save_tests.c: Added TODOS, removed K&R headers, documentation
	, further cosmetics.

2009-09-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Adapt Scanner to changes in API of store.

	* openvasd/openvasd.c (init_openvasd): Use new
	API of store_init.

	* openvasd/nasl_plugins.c (nasl_plugin_add): Use
	new API of store_load_plugin.

	* openvasd/nes_plugins.c (nes_plugin_add): Use
	new API of store_load_plugin.

	* openvasd/oval_plugins.c (oval_plugin_add): Use
	new API of store_load_plugin.

2009-09-10  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/save_tests.c (save_tests_write_data): Minor reformatting,
	added todo about possible mem leak, documentation.

	* openvasd/save_tests.c (save_tests_playback): Reformatted.

2009-09-10  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* doc/Doxyfile, doc/Doxyfile_full: Added alias to generate todo list
	from both lower and uppercase @TODOs.

2009-09-08  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Fixed broken build and reduced code base by:
	Replacing/merged pluginschedulers name cache by arglists ones. Note that
	the latter is considerably smaller and might thus lead to more
	collisions and decreased performance, but improves maintainability and
	memory imprint.

	* openvasd/pluginscheduler.c (struct name_cache, cache_init,
	cache_get_name, cache_add_name, cache_inc, cache_dec): Removed, are
	linked with openvas-libraries.

	* openvasd/pluginscheduler.c (HASH_MAX): Decreased to value found in
	openvas-libraries/misc/arglists.c.

	* openvasd/pluginscheduler.c (mkhash): Replaced by implementation found
	in openvas-libraries/misc/arglists.c .

	* openvasd/pluginscheduler.c: include arglists.h, added TODO.

2009-09-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/openvasd.8.in: Removed note on "admin_user": This functionality
	does not exist anymore.

2009-09-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/openvad.c (main_loop): Adjusted call API for SSL initialization.

2009-09-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* configure: Regenerated.

2009-08-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* configure.in, openvasd/Makefile: Removed libnasl dependence (is
	pulled in via libraries).

2009-08-31  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/preferences.c (preferences_new): Fixed typo.

2009-08-27  Chandrashekhar B <bchandra@secpod.com>

	Some more changes to move openvasd server to support ipv6
	and a bug fix in checking rules.
	Coding by Srinivasa NL <nl.srinivas@gmail.com>.

	* openvasd/attack.c (struct attack_start_args, attack_init_hostinfos,
	attack_start, attack_network): Added support for ipv6. Uses latest library
	function, hg_get_name_from_ip.
	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c (banner_grab): Added
	support for ipv6. Open ipv4 or ipv6 socket depending on target type.
	* openvasd/rules.c (get_host_rules): Resolved a bug while assigning
	and comparing ip addresses.

2009-08-28  Tim Brown <timb@openvas.org>

	* openvasd/oval_plugins.c: Further format string fixes from Stephan
	Kleine.

2009-08-25  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/openvasd.c (main): Added commandline option to expose the
	system configuration directory value as set during configure.

2009-08-24  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* TODO: Updated. Plugin upload is removed (CR#4). Cache needed
	for the time being. No need to migrate from arlist to harglist
	because the whole arglist is to be removed eventually (as
	discussed on OpenVAS DevCon2. Debian has been mostly redone anyway.

2009-08-24  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Moved header files from include/ to the synscan C-NVT because
	this is the only one that uses these includes.

	* include/nessusicmp.h: Moved to cnvts/synscan/nessusicmp.h
	* include/nessusip.h: Moved to cnvts/synscan/nessusip.h
	* include/nessusudp.h: Moved to cnvts/synscan/nessusudp.h
	* include/nessusraw.h: Moved to cnvts/synscan/nessusraw.h
	* include/nessustcp.h: Moved to cnvts/synscan/nessustcp.h

	* MANIFEST: Updated.

2009-08-24  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* Makefile: Don't install any header files anymore. The only
	code that was using these was in former openvas-plugins and
	is now part of openvas-server.

2009-08-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/openvasd.c (init_network): Changed API from "in_addr"
	to using "addrinfo". Added support for IPv6.
	(server_thread): Added support for IPv6.
	(main_loop): Added support for IPv6.
	(init_openvasd): Adapt structures (in_addr to addrinfo).
	(main): Added support for IPv6.

2009-08-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/Makefile: Added missing dependency for modules "users",
	"ntp_11" and "openvasd".

	* openvasd/users.c (users_add_rule): Adjust to new rules data,
	for the time being assuming only IPv4.

	* openvasd/ntp_11.c (ntp_11_rules): Adjust to new rules data,
	for the time being assuming only IPv4.

2009-08-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Initializing implementation for IPv6 support.
	This corresponds to Change Request #27,
	http://www.openvas.org/openvas-cr-27.html
	Most work done by Srinivasa NL <nl.srinivas@gmail.com>.

	* openvasd/rules.h: Added type "inaddrs_t" as union to hold
	either IPv6 or IPv4 address.
	(struct openvas_rules): Adapted to above and added family.
	Adpated protos according to new type.

	* openvasd/rules.c (rules_validateandgetipaddr, rules_ipv6addrmask): New.
	(rules_init_aux): Mostly rewritten to support IPv6 addresses.
	(rules_dup_aux, rules_dup): Removed. These functions are never used.
	(rules_set_client_ip): API changed (family added). Now supports IPv6.
	(rules_add): Added support of IPv6.
	(rules_dump): Added support of IPv6.
	(get_host_rules): Removed recursion decision. Added support of IPv6.

	* openvasd/attack.c (attack_network): Adapt to new API for considerung
	also IPv6 addesses when checking for access rules.

2009-08-10 Vlatko Kosturjak <kost@linux.hr>

	* cnvts/3com_hub/Makefile, cnvts/3com_hub/3com_hub.c:

2009-08-19  Tim Brown <timb@nth-dimension.org.uk>

	* openvas-adduser.in, openvas-rmuser.in: Fixed bashism.

	* openvas-mkcert.in, openvas-mkcert-client.in: Fixed bashism.

2009-08-19  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* configure.in, configure: Raised the required versions of
	openvas-libnasl (2.0.2) and openvas-libraries (2.0.4) and regenerated
	configure.

2009-08-19  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Backported from branches, revision 4581.

	* openvasd/attack.c (launch_plugin):
	Resolved case where uninitialized char* (error) reached fprintf.

2009-08-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/parser.c:
	Added TODO because of code duplication in client.
	Added TODO about possible code improvement.
	Reformatted, added documentation.
	Removed number of calls to strlen.

2009-08-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/attack.c,
	openvasd/comm.c,
	openvasd/hosts.c:
	Cosmetics.

	* openvasd/comm.c (qsort_cmp):
	Added TODO regarding sorting mechanisms (consolidate, improve function
	naming).

	* openvasd/hosts.c (struct host):
	Added TODO, as this struct could be stripped down and put in a list or
	hashtable.

2009-08-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/comm.h:
	Whitespace removal, corrected filename in comment.

	* ChangeLog:
	Minor reformatting.

2009-08-10  Vlatko Kosturjak <kost@linux.hr>

	* cnvts/3com_hub/Makefile,
	cnvts/3com_hub/3com_hub.c:
	removal of 3com_hub C plugin.  Plugin did not work (return
	function at the beginning of plugin) and it is superseeded by
	scripts/remote-net-hub-3com.nasl

2009-08-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* packaging/debian/watch,
	packaging/debian/changelog:
	Removed/moved to /openvas-packaging/openvas-server/debian/trunk.

2009-08-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* packaging/debian,
	packaging/debian/openvas-server.dirs,
	packaging/debian/control,
	packaging/debian/openvas-server.init,
	packaging/debian/compat,
	packaging/debian/openvas-server.config,
	packaging/debian/openvas-server.install,
	packaging/debian/patches,
	packaging/debian/patches/12_openvas_nvt-sync-var.dpatch,
	packaging/debian/patches/10_bashism.dpatch,
	packaging/debian/patches/00list,
	packaging/debian/patches/11_openvas-nvt-sync.dpatch,
	packaging/debian/changelog,
	packaging/debian/rules,
	packaging/debian/openvas-server-dev.dirs,
	packaging/debian/openvas-server-dev.install,
	packaging/debian/openvas-server.postinst,
	packaging/debian/openvas-server.default,
	packaging/debian/openvas-server.postrm,
	packaging/debian/openvas-server.prerm,
	packaging/debian/openvasd.conf,
	packaging/debian/openvas-server.docs,
	packaging/debian/copyright,
	packaging/debian/openvas-server.templates,
	packaging/debian/po,
	packaging/debian/po/gl.po,
	packaging/debian/po/cs.po,
	packaging/debian/po/pt_BR.po,
	packaging/debian/po/es.po,
	packaging/debian/po/fr.po,
	packaging/debian/po/nl.po,
	packaging/debian/po/eu.po,
	packaging/debian/po/it.po,
	packaging/debian/po/POTFILES.in,
	packaging/debian/po/sk.po,
	packaging/debian/po/vi.po,
	packaging/debian/po/templates.pot,
	packaging/debian/po/pt.po,
	packaging/debian/po/ru.po,
	packaging/debian/po/de.po,
	packaging/debian/po/sv.po,
	packaging/debian/po/ja.po,
	packaging/debian/openvas-server.logrotate,
	packaging/debian/README.Debian:
	Removed.
	Was moved to /openvas-packaging/openvas-server/debian/trunk.

2009-08-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/ssl_ciphers/ssl_ciphers.c: Removed setting
	of french name. Also removed a commented-out alternative
	description.

2009-07-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/oval_plugins.c (oval_plugin_add): Setting a
	dependency and mandatory key for any OVAL file.
	This prevent OpenVAS to try to run OVAL files
	if no adequate ovaldi is present.

2009-07-28  Jan Wagner <waja@cyconet.org>

	* packaging/debian/changelog, packaging/debian/control,
	packaging/debian/openvas-server.init,
	packaging/debian/patches,
	packaging/debian/patches/12_openvas_nvt-sync-var.dpatch,
	packaging/debian/patches/10_bashism.dpatch,
	packaging/debian/patches/00list,
	packaging/debian/patches/11_openvas-nvt-sync.dpatch,
	packaging/debian/rules, packaging/debian/openvas-server.postinst,
	packaging/debian/openvasd.conf, packaging/debian/copyright,
	packaging/debian/po/es.po, packaging/debian/po/it.po,
	packaging/debian/po/ja.po:

	- New upstream release
	- Bump Standards-Version to 3.8.2, no changes needed
	- removing absolute path calling rm in postinst, lintian fix.
	- add checkbashisms check for /usr/*bin/openvas-* and add devscripts as
	  build-dep
	- add it.po, thanks to Vincenzo Campanella (Closes: #513361)
	- updates ja.po, thanks to Hideki Yamane (Closes: #538253)
	- add dpatch infrastructure
	- add 10_bashism.dpatch to get rid of bashism in upstream shell scripts,
	  thanks to Raphael Geissert (Closes: #530156)
	- relicense packaging to GPL-3
	- Minor changes to the Spanish translation, it was missing the
	  review done in the debian-l10n-spanish mailing list by
	  Noel David Torres.
	- Small fix in the error message in the init.d script when complaining that
	  there is no ca_file defined.
	- New patch (11_openvas-nvt-sync.dpatch) to include upstream's openvas-nvt-sync
	  that was previously in openvas-plugins package. This enables admins to update
	  their OpenVAS plugins without the need for a separate plugin which, anyway,
	  upstream is not going to provide see Change Request #32
	  (http://www.openvas.org/openvas-cr-32.html, "Discontinuing the tarball
	  releases of openvas-plugins") (Closes: #534846, #532937)
	- Add 12_openvas_nvt-sync-var.dpatch to get the plugins into /var
	- Add the following packages to Recommends: as they are needed by some NASL script:
	  # nmap - so the server can do portscans
	  # smbclient - to retrieve information from "other" environments
	- Add the following packages to Suggests: as they are needed by some NASL script:
	  # snmp - snmpwalk is used in the snmpwalk_portscan.nasl NASL script
	  # pnscan - used by the pnscan.nasl NASL script
	  # strobe - used by the portscan-strobe.nasl NASL script
	  # ike-scan - used by the ike-scan.nasl NASL script
	- add debian/watch to detect when a new version is available at wald.intevation.org
	- Updated Spanish translation
	- Add Japanese translation, it is, however, out of date since the templates
	  have changed (Closes: 520063)

2009-07-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/plugs_req.c (mandatory_requirements_met): Switched
	return code meaning. Now returns correctly.

	* openvasd/pluginscheduler.c (plugins_scheduler_init): Added
	handling for mandatory keys.

2009-07-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Add handling for mandatory_keys. This is part of
	implementing Change Request #39,
	http://www.openvas.org/openvas-cr-39.html.

	* openvasd/pluginscheduler.h (struct scheduler_plugin): Added
	element for mandatory_keys.

	* openvasd/plugs_req.c (mandatory_requirements_met): New.
	Checks whether mandatory requirments (so far only KB keys).

	* openvasd/plugs_req.h: Added proto for mandatory_requirements_met.

	* openvasd/attack.c (launch_plugin): Take care the plugin
	in only launched if mandatory requirements are met. This
	esentially means regardless of flag optmize flag set.

2009-07-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	First part of fixing bug #779.
	Result of collaborative effort of Chandra, Thomas Reinke, Jan-Oliver
	Wagner, Michael Wiegand, Felix Wolfsteller.

	* openvasd/utils.c (common):
	Fixed. In a list comparison, after the first pass no further
	comparisons were done. Keeping pointer to start of list.

2009-06-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* Makefile: Activate installation of C-NVTs.

2009-06-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c (banner_grab,
	read_sysctl_maxsysfd): Resolved unused variables.
	(compute_min_max_cnx, read_sysctl_maxsysfd): Consider only if needed.
	(banner_grab): Resolving ambigious 'else'. Resolve 'parentheses around &&
	within ||'. Resolve missing initialization.

2009-06-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/find_service/find_service.c(plugin_do_run): Resolved ambigious 'else'
	and signedness warning.

2009-06-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* cnvts/synscan/synscan.c (extracttcp, extractsport, issynack, find_rtt,
	sendpacket, scan, plugin_run): Removed unused variable(s).

2009-06-29  Michael Wiegand <michael.wiegand@intevation.de>

	Re-enabled compilation of legacy C-based plugins. Done in accordance
	with CR #32: "Discontinuing the tarball releases of openvas-plugins"
	(http://www.openvas.org/openvas-cr-32.html). This included adding
	libtool support to openvas-server.

	* configure.in: Make configure libtool-aware.

	* configure: Regenerated.

	* ltmain.sh: Added libtool support script.

	* Makefile: Enabled compilation of CNVTs.

	* aclocal.m4: Regenerated to add libtool support.

	* openvas.tmpl.in: Define libtool location to expose it to the CNVT
	Makefiles.

	* cnvts/3com_hub/Makefile: Fixed to integrate into openvas-server build
	environment in order to re-enable compilation.

	* cnvts/find_service/Makefile: Fixed to integrate into openvas-server
	build environment in order to re-enable compilation.

	* cnvts/openvas_tcp_scanner/Makefile: Fixed to integrate into
	openvas-server build environment in order to re-enable compilation.

	* cnvts/ssl_ciphers/Makefile: Fixed to integrate into openvas-server
	build environment in order to re-enable compilation.

	* cnvts/synscan/Makefile: Fixed to integrate into openvas-server build
	environment in order to re-enable compilation.

2009-06-29  Michael Wiegand <michael.wiegand@intevation.de>

	* cnvts/synscan/synscan.c (plugin_init): Adapted calls of plug_set_*
	functions to API change.

2009-06-29  Michael Wiegand <michael.wiegand@intevation.de>

	* cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c (plugin_init):
	Adapted calls of plug_set_* functions to API change.

2009-06-29  Michael Wiegand <michael.wiegand@intevation.de>

	* cnvts/find_service/find_service.c: Removed obsolete French defines.
	(plugin_init): Adapted calls of plug_set_* functions to API change.

2009-06-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* configure.in: Removed handling of language setting.

	* configure: updated.

2009-06-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/oval_plugin.c (oval_plugin_add): Adapated
	calls of plug_set_* functions to API change.

2009-06-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/openvasd.c (init_openvasd): Don't use the
	deprecated method store_init_sys.

2009-06-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/preferences.c (preferences_new): Removed creation
	of parameter "language".

	* openvasd/nasl_plugins.c (nasl_plugin_add): Removed
	handling of language.

	* include/config.h.in, configure.in: Removed handling
	of OPENVASD_LANGUAGE.

2009-06-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* openvasd/comm.c (send_plug_info): Fixed a bug regarding missing
	desc. Removed unnecessary NULL setting.

2009-06-23  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c: Making sure the copyright and summary is
	correctly set for OVAL plugins.
	(start_element, text, end_element): Add support for parsing "rights"
	element.
	(oval_plugin_add): Set copyright and summary when adding OVAL plugins
	to the cache.

2009-06-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/comm.c (send_plug_info): Fixed a bug regarding setting
	a placeholder name. Also improved error reporting to inform
	about as many problems as possible already during the first run.

2009-06-23  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c (ovaldi_launch): Make sure collected_objects
	element is only created if objects have been collected.

2009-06-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/comm.c (send_plug_info): More verbose error
	reports about inconsistent data to allow easier debugging.

2009-06-19  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile: Add targets for handling the cnvts
	and hook  them in except for all- and install-target
	- since the c-nvts do not build yet.

2009-06-19  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Move the remaining C-NVTs from openvas-plugins
	module here.
	This is part of Change Request #32
	(http://www.openvas.org/openvas-cr-32.html,
	"Discontinuing the tarball releases of openvas-plugins")

	* cnvts/3com_hub/3com_hub.c, cnvts/3com_hub/Makefile,
	cnvts/find_service/find_service.c, cnvts/find_service/Makefile,
	cnvts/install_plug, cnvts/make_world,
	cnvts/openvas_tcp_scanner/Makefile,
	cnvts/openvas_tcp_scanner/openvas_tcp_scanner.c,
	cnvts/ssl_ciphers/Makefile, cnvts/ssl_ciphers/ssl_ciphers.c,
	cnvts/synscan/Makefile, cnvts/synscan/synscan.c:
	New. Copied over from openvas-plugins/plugins/

	* MANIFEST: Updated

2009-06-10  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Move the sync-script for the OpenVAS NVT Feed from
	openvas-plugins module here.
	This is part of Change Request #32
	(http://www.openvas.org/openvas-cr-32.html,
	"Discontinuing the tarball releases of openvas-plugins")

	* openvas-nvt-sync.in: New. Moved here from
	openvas-plugins module.

	* configure.in, Makefile: Added handling for openvas-nvt-sync.

	* configure: Updatd.

	* MANIFEST: Updated.

2009-06-03  Michael Wiegand <michael.wiegand@intevation.de>

	Post branch version bump.

	* VERSION: Set to 2.1.0.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-06-03  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.3.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-06-03  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-server 2.0.2 release.

	* VERSION: Set to 2.0.2.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

	* CHANGES: Updated.

2009-05-18  Michael Wiegand <michael.wiegand@intevation.de>

	* packaging/debian/openvas-server.init (check_certs): Fixed error
	message when there is no ca_file setting in the openvasd.conf.

2009-05-11  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/plugs_hash.c (plugins_hash): Remove obsolete variable
	declaration for "uhome".

2009-05-11  Michael Wiegand <michael.wiegand@intevation.de>

	Implementing the first part of Change Request #31: Remove support for
	plaintext password storage (http://www.openvas.org/openvas-cr-31.html).

	* openvasd/users.c (check_user): openvasd will now display a warning
	message on both stderr and the logfile when it encounters a password
	stored in plaintext.

	* openvas-adduser.in: Adding users without a working md5 algorithm is no
	longer possible. Added an exit 1 in case no algorithm is found, removed
	now obsolete reference to plaintext storage when storing credentials.

	* doc/openvas-adduser.8: Updated, removed obsolete parts.

2009-05-05  Jan Wagner <waja@cyconet.org>

	* packaging/debian/changelog: reengineered Michaels changes :P

2009-04-27  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/plugs_hash.c (plugins_hash): Remove handling of obsolete
	"plugins" directory in the user_home directory.

2009-04-20  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-adduser.in: Stop openvas-adduser from creating the now
	obsolete "plugins" directory for new users.

2009-04-20  Michael Wiegand <michael.wiegand@intevation.de>

	* packaging/debian/openvas-server.dirs: Added var/cache/openvas to the
	list of directories to be created.

2009-04-20  Michael Wiegand <michael.wiegand@intevation.de>

	* packaging/debian/control, packaging/debian/compat: Adjusting debhelper
	dependency and compatibility level to be consistent with the other
	modules and to allow Debian Etch packages to be built.

2009-04-17  Michael Wiegand <michael.wiegand@intevation.de>

	Updated Debian packaging files.

	* packaging/debian/openvas-server.dirs: Added etc/openvas/gnupg to the
	list of directories to be created.

	* packaging/debian/control: Updated build dependencies. Added dependency
	to openssl since it is need by the Debian post-inst script.

	* packaging/debian/openvas-server.install: Added usr/bin/openvasd-config
	to the list of files of to be installed. It was formerly installed with
	openvas-server-dev but is needed by some third party tools.

	* packaging/debian/openvas-server-dev.install: Removed
	usr/bin/openvasd-config from the list of files to be installed (see
	above).

	* packaging/debian/openvas-server.default: Changed the default to make
	openvasd listen on external interfaces as well.

	* packaging/debian/openvasd.conf: Updated with new preferences for the
	2.0.x series and fixed wrong entry for dumpfile.

2009-04-09  Michael Wiegand <michael.wiegand@intevation.de>

	* MANIFEST: Added missing ChangeLog.

2009-04-09  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Reformatting and doc in comm module.

	* openvasd/comm.c: Reformatting, doc.

2009-04-09  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Renamed variables starting with 'g_', as it suggest GLib ownership.

	* openvasd/openvasd.c, openvasd/utils.c: Renamed variables starting
	with 'g_'.

2009-04-08  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Reformatting in pluginlaunch module.

	* openvasd/pluginlaunch.c: Reformatting.

2009-04-08  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/nasl_plugins.c (nasl_plugin_add): Added carriage return and
	newline to message to improve readability.

2009-04-07  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Print message to stderr when a nasl script could not be cached.
	This happens in cases where exit() is called prior to the description.
	As a consequence of that non-happening description parse, the nvt might
	not be visible to the client.

	* openvasd/nasl_plugins.c (nasl_plugin_add): Be loud when a script could
	not be added to the cache.

2009-04-06  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/nasl_plugins.c: Minor reformatting, doc.

2009-04-02  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Removed build-breaking debug code.

	* openvasd/openvasd.c: Removed build-breaking debug code.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Cosmetics, reformatting, doc in nasl_plugins module.

	* openvasd/nasl_plugins.c: Cosmetics, doc, reformatting.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Added todos and fixmes in openvasd module, reformatting, doc.

	* openvasd/openvasd.c: Cosmetics, doc, reformatting, todos and fixmes.

2009-03-20  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/pluginscheduler.c (hash_fill_deps): Improved searching for
	dependencies: If plugin some_path/x.nasl has a dependency on y.nasl
	which can not be found, hash_fill_deps will now make attempt to find the
	dependency in some_path/y.nasl.

2009-03-18  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c (ovaldi_launch): Added initial support for
	FDCC checks in the form of support for creating user_items and sid_items
	based on data collected via WMI; note that this is just an early proof
	of concept and contains a number of hacks. oval_plugins.c now uses the
	GString functionality provided by glib to construct the
	collected_objects and system_data elements to account for relations
	between child elements of those elements. Furthermore, oval_plugins.c
	will now attempt to remove stale result files before running ovaldi to
	prevent the reporting of incorrect results when ovaldi failed to
	construct a result file.

2008-03-05  Vlatko Kosturjak <kost@linux.hr>

	* configure, configure.in: Removal of  PCAP_TIMEOUT_IGNORED which
	is not used any more in the source

2009-03-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Increased the required openvas-libraries version (2.0.2), for updated
	ssh_login datastructure.

	* configure.in: Increased required openvas-libraries version to 2.0.2.

2009-03-02  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c: Code cleanup. Renamed child_setup to
	drop_privileges to make the function intention more clear. Removed
	superfluous result variable.

2009-03-02  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c: Beautification commit, no code changes.
	Made indentation consistent with the coding style, added
	documentation.

2009-02-27  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Support for per-host password based local checks. Yet ignored because
	ssh_func.inc will always try the key-based method.

	NOTE: You need the latest version of openvas-libraries to compile and
	the latest Client + the ssh_authorization.nasl that was sent to
	openvas-devel to test.

	* openvasd/attack.c (fill_host_kb_ssh_credentials): Set password in kb
	if specified.

2009-02-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/save_kb.c (kb_dirname): use GLibs build_filename (code was
	already accidentially commited in last commit but not accessible) and
	return gchar instead of manual path construction and char*.

	* openvasd/save_kb.c (kb_fname): respect new return type of kb_dirname,
	free by g_free, corrected comment.

2009-02-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	More Reformatting and documentation for save_kb module, enabled
	doc generation for ENABLE_SAVE_KB guarded code parts.

	* openvasd/save_kb.c: Documentation and reformatting works.

	* doc/Doxyfile, doc/Doxyfile_full: Use a PREDEFINE for ENABLE_SAVE_KB
	to generate more documentation.

2009-02-25  Michael Wiegand <michael.wiegand@intevation.de>

	Added support for parsing multiple results per OVAL result file, made
	call to ovaldi compatible to ovaldi 5.5.x.

	* oval_plugins.c (start_element, end_element): Added support for
	multiple results.
	(ovaldi_launch): Added support for communicating multiple results to
	client. Improved result string handling. Free memory we no longer need.

2009-02-24  Michael Wiegand <michael.wiegand@intevation.de>

	Added support for parsing multiple definitions per OVAL file, made XML
	parsing more robust. Please note that the usefulness of this change is
	limited at the moment, since support for multiple results and updated
	ovaldi support is not yet present in the code, but expected to arrive
	shortly.

	* oval_plugins.c (start_element, text, end_element): Made XML parsing
	more stateful and robust.
	(text): Fix to remove superflous whitespaces in definition titles.
	(ovaldi_launch): Temporarily included dummy values in OVAL system_info
	element for testing.

2009-02-19  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Set default value for Silent Dependencies to 'No'. Naive users otherwise
	might miss some security issues due to suppression of messages coming
	from the server through NVTs that other NVTs just depend on.

	* openvasd/preferences.d: Set default value for silent_dependencies
	to 'no'.

2009-02-19  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/preferences.d: Documentation and minor formatting.
	Added a FIXME about possible conflict with a new scan overiding
	preference values of running scans.

2009-02-17  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/preferences.c (preferences_new): Fixed minor spelling errors
	in comments of newly created preferences files.

2009-02-17  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Set PROJECT_NUMBER to 2.0.2.SVN.

2009-02-17  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-server 2.0.1 release.

	* CHANGES: Updated.

	* README: Extended instructions for server setup.

	* ChangeLog: Tidied.

	* VERSION: Set to 2.0.1.

	* doc/Doxyfile, doc/Doxyfile_full: Set PROJECT_NUMBER to 2.0.1.

2009-02-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Minor documentation added / transformed into agreed format.
	K&R function declarations replaced.

	* openvasd/nasl_plugins.c, openvasd/utils.c, openvasd/utils.h,
	openvasd/shared_socket.c, openvasd/oval_plugins.c, openvasd/pluginload.h
	: Replaced some K&R function declarations, reformatted or added minor
	documentation blocks.

	* ChangeLog: Fixed misleading and wrong entry of last commit.

2009-02-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/preferences.c (preferences_plugin_timeout): Use
	g_strdup_printf instead of malloc + printf.

2009-02-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/preferences.c: Partly reformatted and doc

	* openvasd/preferences.c (preferences_plugin_timeout): (fully)
	reformatted + doc.

2009-02-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/openvasd.c: In mainpage doc, corrected section name.

2009-02-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/openvasd.c: Added mainpage directive for code documentation.
	Included README and LICENSE files in the mainpage.

2009-02-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Replaced outdated INSTALL by slightly more verbose README.

	* INSTALL: Removed. Information was few and outdated. Superseded by
	README.

	* README: New. Contains installation and set-up instructions.

	* MANIFEST: Updated (-INSTALL +README).

2009-02-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Format and doc in openvasd module.

	* openvasd/openvasd.c: Transformed function headers, replaced static
	var from middle of file to beginning of file, transformed comments.

2009-02-13  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/pluginload.c (plugins_reload_from_dir): Don't try to split
	include_folders if there is no such preference.

2009-02-13  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/pluginscheduler.c (hash_fill_deps): Improved
	warning message to avoid misinterpretation.

	* openvasd/shared_socket.c (shared_socket_process): Improved
	documentation.

	* openvasd/pluginlaunch.c (read_running_processes): Write a
	log entry in case of process_internal_msg fails.

	* Makefile: Renamed old target "doc" to "man" to avoid
	having two targets "doc".

2009-02-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* doc/Doxyfile, doc/Doxyfile_full: New. Directives for
	creation of doxygen source code documentation.

	* Makefile: Added targets "doc" and "doc-full".

	* MANIFEST: Updated.

2009-02-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Repaired resolution of Default or pattern- defined logins per host,
	printf Debug- messages.

	* openvasd/attack.c (fill_host_kb_ssh_credentials): Check if login
	is registered under keys before resolution, debug messages.

	* openvasd/attack.c (pattern_matches): printf debug messages.

2009-02-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Resolved bug when per-target ssh login information was already added in
	an arglist, has to be set be become replaced.

	* openvasd/ntp_11.c (build_global_sshlogin_info_map,
	build_global_host_sshlogins_map): If value alread found in arglist
	replace it.

2009-02-10  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/pluginload.c (plugins_reload_from_dir): Add support for
	multiple, colon-separated include_folders in the preferences.

2009-02-10  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/control, packaging/debian/changelog,
	packaging/debian/openvas-server.templates, packaging/debian/po/gl.po,
	packaging/debian/po/cs.po, packaging/debian/po/pt_BR.po,
	packaging/debian/po/es.po, packaging/debian/po/fr.po,
	packaging/debian/po/eu.po, packaging/debian/po/nl.po,
	packaging/debian/po/sk.po, packaging/debian/po/vi.po,
	packaging/debian/po/templates.pot, packaging/debian/po/pt.po,
	packaging/debian/po/ru.po, packaging/debian/po/sv.po,
	packaging/debian/po/de.po: Updated following translation efforts
	by debian-l10n-english team as part of the Smith review project.

2009-02-09  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Documentation and reformatting of shared_socket module.

	* openvasd/shared_socket.c: Donated return types in function
	declarations an own line, removed whitespaces, minor documentation.

	* openvasd/shared_socket.c (openvasd_shared_socket_acquire):
	Reformatted.

2009-02-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/preferences.c (preferences_new): Added default for
	config parameter "include_folders". It is set
	to the plugins_folder to be compatible by default
	with older version of openvasd.

	* openvasd/pluginload.c: Added include for nasl.h.
	(plugins_reload_from_dir): Initialize include paths.

2009-02-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Basic support for glob-style pattern definitions within the
	hostname --> sshlogin mapping.
	(CR #20, http://www.openvas.org/openvas-cr-20.html)

	* openvasd/attack.c (is_pattern): New, copied from clients
	nvt_pref_sshlogin, TRUE if string contains '*' or '?'.

	* openvasd/attack.c (pattern_matches): New, GHashTable- find- predicate.

	* openvasd/attack.c (fill_host_kb_ssh_credentials): Now tries if any
	pattern matches the hostname before falling back to Default login.

2009-02-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Refactoring and documentation in attack.c. Minor formatting changes.
	In preparation of pattern definitions for hostname --> sshlogin mapping.
	(CR #20, http://www.openvas.org/openvas-cr-20.html)

	* openvasd/attack.c (attack_init_hostinfos): Documented.

	* openvasd/attack.c (fill_host_kb_ssh_credentials): New, extracted from
	init_host_kb.

	* openvasd/attack.c (init_host_kb): Adjusted to call new method
	fill_host_kb_ssh_credentials.

	* openvasd/attack.c (attack_host): Minor formatting changes.

2009-02-02  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Cosmetics in the rules module.

	* openvasd/rules.h: Documentation and formatting of rules struct.

	* openvasd/rules.c (rules_get_fname): Removed unneeded forward decl.
	Documentation, K&R func decl. replaced.

	* openvasd/rules.c (get_host_rules): K&R func decl. replaced.,
	indentation.

	* openvasd/rules.c (rules_free): K&R func decl. replaced.

2009-01-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/pluginload.c (collect_nvts): Fixed a bug: Now
	subdir paths are correctly assembled and stored.

2009-01-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Introduce a new collection method for NVTs in the
	plugins folder. Now, it is recursed into subdirectories.
	As a side effect, the counting of NVTs is ow fixed: The correct
	total number of NVTs is shown during cache-building.

	* openvasd/pluginload.c (collect_nvts): Collects all files
	in a directory and recurses into subdirectories.
	(plugins_reload_from_dir): Use collect_nvts() instead
	of doing it on its own with glibc API.
	Also use g_str_has_suffix() for determining the plugin type
	instead of doing it on its own with glibc string commands.

2009-01-27  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Fixed SSH key file insertion into per-target knowledge- base.
	Scripts require the actually file content, not only the path.

	* openvasd/attack.c (init_host_kb): Does not set filename but file-
	contents in the knowledge base.

2009-01-27  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c (oval_plugin_add): Add missing path to cache
	file.

2009-01-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/pluginload.c (plugins_reload_from_dir): Instead
	of homebrew "struct files", now uses glibs' GSList.
	(struct files, MAXFILES, files_init, files_add, files_walk,
	files_close): Removed.

2009-01-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/openvasd.c (server_thread): Removed calling
	of plugins_reload_user. Per-user plugins are not a feature
	anymore.

	* openvasd/pluginload.c (plugins_reload_user): Removed. This
	function was a remainder from the plugin-upload feature which
	has been removed.

	* openvasd/pluginload.h: Removed proto accordingly.

2009-01-23  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	When the knowledge base for a host is initialized, look up the "Default"
	value for an ssh-account if no specific found.

	* openvasd/attack.c (init_host_kb): Looks up the account- name for the
	"Default" host, if none for hostname was found.

2009-01-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing unused and unneeded module "dirutils.c".

	* openvasd/dirutils.c: Removed.

	* openvasd/Makefile: Removed handling for dirutils.

	* MANIFEST: Updated.

2009-01-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Implement feature to allow to specify a specific
	directory for the .desc cache files. Defaults
	to /var/cache/openvas.
	No write access should be allowed to /lib/openvas/plugins
	eventually.
	However, compatibility is kept with older versions of
	openvasd.conf: In the absense of cache_folder definition
	in openvasd.conf, the old style is applied.

	It is highly recommended to specific "cache_folder"
	in openvasd.conf and remove old cache ("plugins_folder"/.desc).

	This change was derived from patches from Stjepan Gros.

	* openvasd/preferences.c (preferences_new): Added "cache_folder"
	with default.

	* configure.in, openvas.tmpl.in: add handling of OPENVASD_CACHE.

	* Makefile: Create configure cache dir during install

	* configure: updated.

2009-01-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/openvasd.c (init_openvasd): First try "cache_folder"
	preference for cache folder. Fall back to old
	folder (plugins_folder/.desc).

2009-01-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/nasl_plugins.c (nasl_plugin_add, nasl_thread):
	Use exec_nasl_script instead of execute_nasl_script.
	Subsequently, remove any handling of the unneeded cache_dir.

2009-01-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in: Upgraded dependency for openvas-libraries
	and openvas-libnasl both to 2.0.1

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	When the knowledge base for a host is initialized, look up any ssh
	credentials information (that should be accessible if a nvt with a
	PREF_SSH_CREDENTIALS preference was available to the client and the user
	did specify the information).

	* openvasd/attack.c (init_host_kb): Comment added, empty newline removed.
	Looks up the hostname and user-defined login- account for the current
	host. Then adds "Secret/SSH/*" entries with this information to the
	knowledge base of the current host.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/ntp_11.c (files_add_translation): Commented, replaced K&R
	function declaration.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Parses the files that the client might sent if a plugin with a 'special'
	preference (PREF_SSH_CREDENTIALS) requested it.
	!Note that you need a recent openvas-libraries install to be able to
	compile!

	* openvasd/ntp_11.c (build_global_host_sshlogins_map): New.
	Parses the .host_logins file sent by the client and stores the mapping
	of user-defined login-account names to hostnames in the global arglist
	for later (per-host) lookup.

	* openvasd/ntp_11.c (build_global_sshlogin_info_map): New.
	Parses the .logins file sent by the client and stores the mapping of
	user-defined login-account names to openvas_ssh_login structs for later
	lookup and extraction of per-host login information.

	* openvasd/ntp_11.c (ntp_11_recv_file): Commented, calls the new methods
	accordingly if a file with the appropriate name has been received.

2009-01-20  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-adduser.in, openvas-mkcert.in, openvas-mkcert-client.in,
	openvas-rmuser.in: Make gettext usage more robust; previous versions
	expected gettext.sh to be in /usr/bin which is not always the case. This
	resolves bug #860 (http://bugs.openvas.org/).

2009-01-19  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd-config.in: Added support for retrieving the sbindir of an
	OpenVAS installation.

2009-01-19  Michael Wiegand <michael.wiegand@intevation.de>

	* Makefile: Fixed permissions for openvas/gnupg directory.

2009-01-16  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Cosmetics (reformatted ntp_11_recv_file, docs).

	* openvasd/ntp_11.c (ntp_11_recv_file): Reformatted.

	* openvasd/ntp_11.c: Tiny doc improvements.

2009-01-15  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd-config.in: Added support for retrieving the sysconfdir and
	libdir of an OpenVAS installation.

2009-01-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/openvasd.c (main): Removed exit-upon-nonroot,
	because there is no reason why only root should start
	the server. It works well except for those
	operation where root privileges are needed.
	In cases where privileges are not sufficient, the
	log file will contain respective notes.

	* openvas-mkcert.in, openvas-adduser.in: Don't have
	it mandatory to be root.

2009-01-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Cosmetics (reformatted ntp_11_recv_file, docs).

	* openvasd/ntp_11.c (ntp_11_recv_file): Reformatted.

	* openvasd/ntp_11.c: Reformatted.

2009-01-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Refactoring attack method.

	* openvasd/attack.c (launch_plugin): Changed int to gboolean parameter,
	doc.

	* openvasd/attack.c (init_host_kb): New method, extracted from
	attack_host, comments, documentation.

	* openvasd/attack.c (attack_host): Changed new_kb to be gboolean,
	extracted init_host_kb function.

2009-01-07  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/attack.c (attack_host): Removed local unused variable
	kb_restored.

2009-01-07  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/attack.c (attack_host, attack_start): Reformatted.

	* openvasd/attack.c (attack_network): Remoded local unused variable
	return_code, added comment.

2009-01-07  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Comment style transformed to JavaDoc style, duplicate code found and
	TODOs added.

	* openvasd/save_kb.c: Transformed comments to JavaDoc style, minor
	improvements, added note about code duplicates in save_tests.c.

	* openvasd/save_tests.c: Added note about code duplicate in save_kb.c.

2009-01-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/attack.c (attack_network, launch_plugin) : Replaced tabs by
	spaces, repaired indentation & newlines, ready for refactoring.

2009-01-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/openvasd.c (server_thread): Removed initialization
	of user-specific store (which happened after the fork) and
	lead to create of directory ".desc" in the
	/var/lib/openvas/users/USER/plugins.
	This code are remains of the unsecure feature of plugin
	upload. Apart from this, the OpenVAS Server should eventually
	not be responisble anymore for user-specific data storage.

2009-01-02  Michael Wiegand <michael.wiegand@intevation.de>

	* include/config.h.in, openvasd/openvasd.c: Changed
	OPENVASD_IANA_OTP_PORT to OPENVAS_IANA_OTP_PORT.

2009-01-02  Michael Wiegand <michael.wiegand@intevation.de>

	Modified openvasd to use the freshly allocated IANA port 9390 instead of
	the Nessus port 1241.

	* include/config.h.in: Removed NESIANA_PORT define, added
	OPENVASD_IANA_OTP_PORT define. Updated IANA URL.

	* openvasd/openvasd.c: Changed to use OPENVASD_IANA_OTP_PORT, fixed
	references to port 1241 in comment.

	* doc/openvasd.8.in: Mention that the default port is now 9390.

	* openvas-services: Added otp on port 9390 to the list of known
	services.

	* packaging/debian/openvas-server.default: Changed Debian defaults to
	9390.

	* packaging/debian/README.Debian: Mention that the default port in 9390.

2009-01-02  Michael Wiegand <michael.wiegand@intevation.de>

	* ltmain.sh: Removed since libtool is not used in the build process.

	* Makefile: Removed obsolete references to libtool.

2008-12-30  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/attack.c: Replaced K&R header, added comment to attack_host.

2008-12-30  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/attack.c: Replaced K&R header, added comment to attack_host.

2008-12-30  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/attack.c: Transformed comments to Javadoc style.

2008-12-29  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/otp_1_0.c: Applied patch from Hanno Bck to remove unwanted
	gpgme.h include.

	* openvasd/otp_1_0.c (client_request_t otp_1_0_get_client_request):
	Documented, removed K&R header.

	* openvasd/otp_1_0.c (otp_1_0_server_openvas_version): Double starred
	comment.

2008-12-26  Joey Schulze <joey@infodrom.org>

	* packaging/debian/copyright: Added Martin Bagge as new translator

	* packaging/debian/changelog: Import changelog from 1.0.2-5

2008-12-23  Michael Wiegand <michael.wiegand@intevation.de>

	* packaging/debian/po/sv.po: Updated Swedish translation as suggested by
	Martin Bagge.

2008-12-20  Tim Brown <timb@nth-dimension.org.uk>

	* openvas.tmpl.in, ssl/Makefile: Honour LDFLAGS.

2008-12-18  Tim Brown <timb@nth-dimension.org.uk>

	* openvas.tmpl.in: Honour CFLAGS.

2008-12-17  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.1.SVN.

2008-12-17  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-server 2.0.0 release.

	* CHANGES: Updated.

	* VERSION: Set to 2.0.0.

2008-12-16  Michael Wiegand <michael.wiegand@intevation.de>

	Updated build environment to use an up-to-date libtool version.

	* config.guess, config.sub, ltmain.sh, configure: Regenerated.

2008-12-15  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/openvasd.c (init_openvasd): Removed code
	path for condition ENABLE_PLUGIN_SERVER which was
	never true and thus never executed.

2008-12-13  Joey Schulze <joey@infodrom.org>

	* packaging/debian/changelog: Added changelog entry from the
	recently uploaded Debian package

	* packaging/debian/po/de.po, packaging/debian/po/cs.po,
	packaging/debian/po/es.po, packaging/debian/po/fr.po,
	packaging/debian/po/gl.po, packaging/debian/po/nl.po,
	packaging/debian/po/pt.po, packaging/debian/po/pt_BR.po,
	packaging/debian/po/sv.po, packaging/debian/po/templates.pot:
	Updated PO files after debconf-updatepo and adjusting new fuzzy
	translations

	* doc/openvasd.8.in: Fix broken comment

	* packaging/debian/openvas-server.prerm: Add switch to make script
	fail in case of errors

	* packaging/debian/openvas-server.postinst: Switch shell to bash
	to be compliant with bashisms

	* packaging/debian/copyright: Reworked copyright file

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.0.rc2.SVN.

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-server 2.0-rc1 release.

	* CHANGES: Updated.

	* VERSION: Set to 2.0.0.rc1.

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/processes.c (create_process): Ignore warning about srand48
	not being random enough; it is random enough for our purposes.

	* openvasd/pluginload.c (files_init, files_close): Ignore warnings
	about srand not being random enough; see above.

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/comm.c (send_plug_info): Fixed insufficient memory
	allocation which could have caused a buffer overflow when trying to
	assemble the plugin_info string for NVTs with long CVEs, BIDs, XRefs
	and Tags. Made memory allocation more transparent. Ignore strcat
	warnings since enough memory is allocated beforehand now. Ignore
	snprintf warning since systems able to compile and run will most likely
	not use libc4.[45], where snprintf usage is a potential security
	issue.

2008-12-03  Michael Wiegand <michael.wiegand@intevation.de>

	Implementing CR #22 (New script_tag Command,
	http://www.openvas.org/openvas-cr-22.html).

	* openvasd/comm.c (send_plug_info): Added support for sending NVT tags
	to client.

2008-12-02  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/comm.c : Repaired sending NOXREF, NOCVE, NOBID, NOSIGNKEY if
	none found (instead of empty string).

2008-12-02  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/comm.c : Comments added.

2008-11-28  Joey Schulze <joey@infodrom.org>

	* packaging/debian/openvasd.conf: Disable signature check

2008-11-27  Joey Schulze <joey@infodrom.org>

	* packaging/debian/openvas-server.postinst: Corrected server
	restart (init file was renamed from openvasd to openvas-server
	some revisions earlier)

2008-11-21  Joey Schulze <joey@infodrom.org>

	Sync with Debian packaging as uploaded to ftp-master

	* packaging/debian/control: Adjust uploaders, add section for
	openvas-server and -dev

	* packaging/debian/changelog: Add changelog records for versions
	1.0.2-1, 1.0.2-2 and 1.0.2-3

2008-11-19  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/changelog: Updated.

	* packaging/debian/control: Adjusted dependencies to use beta2 versions of the libraries.

2008-11-19  Joey Schulze <joey@infodrom.org>

	* packaging/debian/openvas-server.install: Removed reference to
	openvas-check-signature.1 that was removed

2008-11-19  Michael Wiegand <michael.wiegand@intevation.de>

	* packaging/debian/copyright: Added missing Intevation copyright.

2008-11-18  Michael Wiegand <michael.wiegand@intevation.de>

	Fixing version requirements for glib as pointed out by atomicturtle.

	* configure.in: Updated glib requirements to >= 2.6.0

	* configure: Regenerated.

	* aclocal.m4: Regenerated to update PKG_CHECK_MODULES.

2008-11-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/ntp_11.c: comment added.

	* openvasd/comm.c (comm_send_preferences): Comment, sending
	nasl_no_signature_check as server pref to client.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.0.beta3.SVN.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the 2.0-beta2 release.

	* VERSION: Set to 2.0.0.beta2.

	* MANIFEST: Updated.

	* CHANGES: Updated.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas.tmpl.in, openvas-adduser.in, openvas-mkcert-client.in,
	openvas-rmuser.in: Added datarootdir to remove configure warning and to
	be compatible with autoconf 2.60 (see
	http://www.gnu.org/software/libtool/manual/autoconf/Changed-Directory-Variables.html).

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Applying patch provided by Stjepan Gros to update Makefile target and
	to improve code readability.

	* openvasd/openvasd.c (init_openvasd): Minor reformattings.

	* openvasd/Makefile: Remove openvasd-config when distclean target
	is invoked.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Applying patch provided by Stjepan Gros to eliminate compiler warnings.

	* openvasd/oval_plugins.c (oval_plugin_add, ovaldi_launch): Minor
	reformattings, changes to eliminate compiler warnings.

	* openvasd/otp_1_0.c (otp_1_0_server_send_certificates): Casting to
	eliminate compiler warning.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c (ovaldi_launch): Re-added G_SPAWN_SEARCH_PATH
	flag to g_spawn_sync call since it was lost in rev 1703.

2008-11-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/otp_1_0.c (otp_1_0_server_send_certificates) : closed mem
	leak.

2008-11-12  Michael Wiegand <michael.wiegand@intevation.de>

	Applying patch provided by Stjepan Gros to improve 64-bit cleanliness.

	* openvasd/nasl_plugins.c, openvasd/ntp_11.c, openvasd/attack.c,
	openvasd/save_kb.c, openvasd/openvasd.c, openvasd/nes_plugins.c,
	openvasd/pluginload.c, openvasd/save_tests.c, openvasd/comm.c,
	openvasd/pluginscheduler.c: 32/64-bit cleanups, introduced glib.

2008-11-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Work on Change Request #17 (http://www.openvas.org/openvas-cr-17.html -
	"OTP: Make NVT signatures available to OpenVAS-Client").
	Certificate information sending functionality improved. Sends real
	information, not dummystrings.

	ATTENTION: needs openvas-libnasl rev. 1702 to compile smoothly.

	* configure.in : Macros for gpgme public key support added.

	* include/config.h.in : undef _FILE_OFFSET_BITS for AC_SYS_LARGEFILE

	* configure : regenerated.

	* openvasd/otp_1_0.h : proto added.

	* openvasd/otp_1_0.c (otp_1_0_server_send_certificates) : nasl, glib
	includes. Does send real information, not dummystrings.

	* openvasd/ntp_11.c : removed interpretation of a void return.

	* openvasd/oval_plugins.c : Includes ordered and missing ones added.

	* ChangeLog : shamefully changed typos with my own email adress.

2008-11-12  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Added AC_PREREQ directive to tell autoconf to generate
	a 2.50-style configure script.

	* configure: Regenerated.

2008-11-12  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c: (child_setup) Implemented privilege dropping
	before calling ovaldi. (ovaldi_launch) Improved parsing of RPM package
	list.

2008-11-10  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Include version requirements in glib error string as
	pointed out by Jon Bebeau.

	* configure: Regenerated.

2008-11-10  Michael Wiegand <michael.wiegand@intevation.de>

	Removed openvas-check-signature since signature verification can now be
	done with existing third-party tools like gnupg. Additionally,
	openvas-check-signature was the last executable to depend on the local
	copies of getopt which is no longer provided by openvas-libraries.

	* openvasd/openvas-check-signature.c: Removed.

	* openvasd/Makefile: Removed handling of openvas-check-signature.

	* include/config.h.in: Removed obsolete getopt defines.

	* doc/openvas-check-signature.1: Removed documentation of
	openvas-check-signature.

	* MANIFEST: Updated.

	* Makefile: Updated.

2008-11-07  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/nasl_plugins: Removed printfs.

	* openvasd/otp_1_0.c (otp_1_0_server_send_certificates): Extended dummy
	string, slightly better error msg.

	* oopenvasd/oval_plugins.c (oval_plugin_add): Check certificates, add
	fingerprint string.

	* oopenvasd/oval_plugins.c (oval_plugin_launch): TODO added to avoid
	execution of unsigned plugins, if server preference is set.


2008-11-06  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/otp_1_0.c (otp_1_0_server_send_certificates): Fixed bug
	(wrong type released) that caused definite server crash.


2008-11-06  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c (ovaldi_launch): Added G_SPAWN_SEARCH_PATH
	flag to g_spawn_sync call.

2008-11-05  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/attack.c (launch_plugin): Use OIDs instead of IDs when
	logging information about NVT execution to KB.

2008-11-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Work on Change Request #17 (http://www.openvas.org/openvas-cr-17.html -
	"OTP: Make NVT signatures available to OpenVAS-Client").
	Replaced sending of dummy certificate key oids by "real" fingerprints.
	Sends dummy certificate information.

	* openvasd/nasl_plugins.c (nasl_plugin_add): Replaced the dummy string
	for certificate fingerprints by real value from store / certificate
	file, corrected behaviour for missing signature files.

	* openvasd/otp_1_0.c: Added gpgme dependency and a dummy strings for
	the cerrtificate sending.

	* openvasd/comm.d (send_plug_info): increased size of buffer to send pl.

2008-11-04  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Updated version requirements for -libraries and
	-libnasl.

2008-10-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Steps to an implementation of Change Request #17
	(http://www.openvas.org/openvas-cr-17.html - "Make NVT signatures
	available to OpenVAS-Client").
	Uses the new field "sign_key_ids" of plugin-structures and the .desc
	store. Until soon, just a dummy- string will be used and eventually
	transmitted by the server.

	IMPORTANT: Breaks compatibility and renders old server .desc- cache
	files useless. You will need an openvas-libraries revision >= 1654 in
	order to compile and a client of revision >= 1654 in order to work with
	the server. There might be problems with transmitting OVAL plugins to
	the client.

	* openvasd/nasl_plugins.c (nasl_plugin_add) : Set a dummy key_ids-
	string, improved readability (a bit).

	* openvasd/pluginload.c: Typo in comment fixed.

	* openvasd/oval_plugins.c: Stated a FIXME and removed unreachable NULL
	return.

	* openvasd/otp_1_0.h: Added CREQ_CERTIFICATES symbol.

	* openvasd/otp_1_0.c (otp_1_0_get_client_request,
	otp_1_0_server_send_certificates): Added CREQ_CERTIFICATES parsing and
	a method stub to send the certificates.

	* openvasd/otp_1_0.c (ntp_11_parse_input): Handling of
	CREQ_CERTIFICATES added.

	* openvasd/comm.c (send_plug_info): Sends the additional key_ids field.

	* openvasd/comm.c (comm_setup_plugins): Comment and use of symbol
	instead of numeral.

2008-10-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/nasl_plugins.c (nasl_plugin_add): Replaced obsolete ID check
	 by OID check (might have excluded id-less scripts), added comment.

2008-10-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* openvasd/nsp.h: Removed. Contained include guard and gpl only.

	* Manifest: Updated (removed openvasd/nsp.h).

2008-10-12  Tim Brown <timb@nth-dimension.org.uk>

	* configure: Refreshed auto* (aclocal && autoconf) as ./configure was barfing.

	* configure, configure.in: GLIB needs to be quoted when we pass it to
	PKG_CHECK_MODULES in configure.in, otherwise m4 tries to expand it.

	* Makefile: Now makes $localstatedir/openvas/private/CA

	* packaging/debian/changelog: Updated.

	* packaging/debian/copyright: Updated with details of translators.

	* packaging/debian/rules: Cleaned up.

	* packaging/debian/README.Debian: Updated.

	* packaging/debian/control: Updated standards version. Adjusted
	dependencies to use libopenvas2-dev and libopenvasnasl2-dev.

	* packaging/debian/openvas-server.default: Changed defaults so that it
	listens on 1241 on 127.0.0.1 by default.

	* doc/openvasd-config.1: Added to keep lintian quiet.

	* packaging/debian/openvas-server-dev.dirs, openvas-server-dev.install,
	Makefile: Updated.

2008-10-01  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c: Changed to set OIDs exclusively; setting IDs
	as a workaround for NTP is no longer required.

2008-10-01  Michael Wiegand <michael.wiegand@intevation.de>

	* doc/otp_specification_10.txt: Removed; the specification for OTP has
	been updated and moved to the OpenVAS compendium.

	* MANIFEST: Updated.

2008-09-25  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.0.beta2.SVN

2008-09-25  Michael Wiegand <michael.wiegand@intevation.de>

	Doing the 2.0-beta1 release.

	* VERSION: Set to 2.0.0.beta1

	* CHANGES: Updated.

2008-09-25  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c (ovaldi_launch), openvasd/dirutils.c
	(init_directories): Changed unsafe uses of sprintf to use snprintf with
	the correct buffer sizes.

2008-09-25  Michael Wiegand <michael.wiegand@intevation.de>

	* MANIFEST: Updated.

2008-09-25  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/oval_plugins.c: Added notice regarding running ovaldi with
	reduced privileges.

2008-09-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/comm.c (comm_init):  Removed setting of scan_ids
	and pubkey_auth.

2008-09-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/openvasd.c (server_thread): Removed
	conditional for ntp_11, because this is standard for otp.

	* openvasd/comm.c (comm_init):  Removed setting of ntp_11.
	(comm_wait_order): Removed conditional for ntp_11, because
	this is standard for otp.

	* openvasd/Makefile: Removed module ntp_10.

	* openvasd/ntp_10.h, openvasd/ntp_10.c: Removed. The only
	method defined there is not needed anymore since no ntp_10
	fallback does make sense with otp.

2008-09-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/ntp_11.c (ntp_11_parse_input): Replaced call of ntp_11_prefs()
	by calling ntp_11_read_prefs() for PREFERENCES command. ntp_11_prefs
	does nothing relevant except calling ntp_11_read_prefs.
	(ntp_11_prefs): Removed. It only handled escape_crlf which is fixed to
	true for OTP.

	* openvasd/attack.c (attack_network): Removed retrieval of ntp_caps as
	these are not used here anyway.

	* openvasd/comm.c (comm_init): Removed any consideration of ntpcaps
	element "plugins_xrefs", "timestamps" and "ciphered".

2008-09-19  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/ntp_11.c (ntp_11_prefs, ntp_11_send_prefs_errors): Removed
	support for PREFERENCES ERROR message type as it was never properly
	implemented and is now obsolete.

	* openvasd/comm.c (plugin_send_infos): Tidied up plugin search code,
	fixed possible bug where an plugin would have not been found if it was
	the last plugin in the list.

2008-09-17  Michael Wiegand <michael.wiegand@intevation.de>

	Changed communication protocol to use OTP exclusively now. Removed the
	last instances of dynamic protocol extension selection.

	* openvasd/openvasd.c (server_thread): Ignore obsolete capabilities
	fast_login (gone from client) and md5_caching (default now).

	* openvasd/comm.c: (extract_extensions) Removed. Protocol features are
	no longer supported. (comm_init) Removed handling of NTP 1.0, 1.1 and
	1.2 and added handling of OTP 1.0. Moved remaining default options from
	extract_extensions to comm_init. Changed log message to be more
	descriptive.

2008-09-16  Michael Wiegand <michael.wiegand@intevation.de>

	Optimized plugin selection with OIDs. Selection is now considerably
	faster.

	* openvasd/comm.c: (qsort_cmp) Comparator now compares OIDs instead of
	IDs. (_get_plug_by_id) Removed. (_get_plug_by_oid) Adapted from
	_get_plug_by_id to use OIDs. (get_plug_by_id) Removed. (get_plug_by_oid)
	Adapted from get_plug_by_id to use OIDs. (comm_setup_plugins) Re-enabled
	plugin sorting.

2008-09-15  Michael Wiegand <michael.wiegand@intevation.de>

	Fixes to re-enable plugin loading after the OID changes. Please note
	that the selection of the plugins chosen by the user at the start of a
	new scan is _very_ slow at the moment since the plugin retrieval
	function is not yet optimized.

	* openvasd/nasl_plugins.c (nasl_plugin_launch): Call
	preferences_plugin_timeout with OID instead of ID.

	* openvasd/plugs_hash.c (plugins_send_md5_byid): Send OID instead of ID
	when sending MD5 hashes for plugin. (plugins_send_md5): Removed
	handling of obsolete md5_by_name capability.

	* openvasd/comm.c: Added new get_plug_by_oid function to retrieve
	plugins based on OID. Note that this makes plugin selection _very_ slow
	at the moment since the ID based optimized retrieval could no longer be
	used. (comm_setup_plugins) Changed to parse and use OIDs instead of IDs.

2008-09-11  Javier Fernandez-Sanguino <jfs@debian.org>

	* po/README: Typo fix.

2008-09-10  Michael Wiegand <michael.wiegand@intevation.de>

	Make the plugin timeout settings use OID instead of ID.

	* openvasd/preferences.c (preferences_plugin_timeout): Changed to use
	OIDs.

	* openvasd/preferences.h: Adjusted function declaration.

	* openvasd/pluginlaunch.c (plugin_launch): Call
	preferences_plugin_timeout with OID instead of ID.

2008-09-05  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Make the command PLUGIN_LIST send OIDs instead of old IDs.
	Make the PLUGIN_INFO command be interpreted with OIDs
	instead of IDs.

	* openvasd/comm.c (send_plug_info): Changed behaviour
	that in case there is no OID, the plugin is not sent
	and instead a log message is issued. Previously the ID "1"
	was applied.
	Send OID instead of old ID.
	(plugin_send_infos): Now takes char * oid as second parameter
	instead of int id.

	* openvasd/comm.h: Changed proto for plugin_send_infos accordingly.

	* openvasd/ntp_11.c (ntp_11_parse_input): Call plugin_send_infos
	with its new API.

2008-09-09  Michael Wiegand <michael.wiegand@intevation.de>

	Adding preliminary support for OVAL definitions. Second step for change
	request #13 (Integrating the OVAL interpreter ovaldi into OpenVAS
	Server) (http://www.openvas.org/openvas-cr-13.html)

	* openvasd/oval_plugins.c: First usable proof-of-concept integration of
	OVAL definitions into OpenVAS.

2008-09-08  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/comm.c (extract_extensions): Removed superfluous else that
	broke compilation.

2008-09-05  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Making protocol extension "timestamps" standard.

	* openvasd/ntp_11.c (__ntp_1x_timestamp_scan,
	__ntp_1x_timestamp_scan_host): Removed conditional
	for timestamps.

	* openvasd/comm.c (extract_extensions): Removed conditional
	for "timestamps", it is standard now.

	* doc/otp_specification_10.txt: Updated to described
	that protocol extension "timestamps" has been made standard.

2008-09-02  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-services: Fixed changes from rev 83 that caused the server to
	not report the appropriate port for the service when an open port 1241
	was detected.

2008-09-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Making protocol extension "plugins_version", "plugins_cve_id",
	"plugins_bugtraq_id" and "plugins_xrefs" standard.

	* openvasd/comm.c (extract_extensions): Removed handling
	of "plugins_version" "plugins_cve_id", "plugins_bugtraq_id"
	and "plugins_xrefs" extension.
	(send_plug_info): Always send NVT version, CVE ID, Bugtraq ID
	and cross references.

	* doc/otp_specification_10.txt: Updated to described
	that protocol extension "plugins_version", "plugins_cve_id",
	plugins_bugtraq_id" and "plugins_xrefs" have been made standard.

2008-09-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Making protocol extension "dependencies" standard.

	* openvasd/comm.c (extract_extensions): Removed handling
	of "dependencies" extension.

	* openvasd/openvasd.c (server_thread): Always send dependencies.

	* doc/otp_specification_10.txt: Updated to described
	that protocol extension dependencies has been made standard.

2008-08-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Remove NEW_ATTACK command.

	* openvasd/ntp_11.c (ntp_11_new_attack): Removed.

	* openvasd/otp_1_0.c (otp_1_0_get_client_request): Removed
	NEW_ATTACK handling.

	* openvasd/otp_1_0.h: Removed CREQ_NEW_ATTACK.

2008-08-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/otp_1_0.c (otp_1_0_get_client_request): New method.

	* openvasd/otp_1_0.h: Added proto for
	otp_1_0_get_client_request and added client_request_t.

	* openvasd/ntp_11.c (ntp_11_parse_input): Reorganized
	parsing into a switch-case design. This simplified the code
	and several memory leaks were eliminated.

2008-08-30  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Start the otp 1.0 module with a first simple method.

	* doc/otp_specification_10.txt: Added documentation
	of OPENVAS_VERSION command.

	* openvasd/otp_1_0.h, openvasd/otp_1_0.c: New. This module will
	implements OTP 1.0 and initially contains
	otp_1_0_server_openvas_version().

	* openvasd/Makefile: Handle module otp_1_0.

	* openvasd/ntp_11.c (ntp_11_parse_input): Call
	otp_1_0_server_openvas_version() instead of sending
	text on its own.

	* MANIFEST: updated.

2008-08-29  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* doc/kb_entries.txt: Removed those entries that could be
	integrated into openvas-compendium. Ordered the rest alpabetically
	and attached a big hint about the status of these information.

2008-08-29  Michael Wiegand <michael.wiegand@intevation.de>

	Adding preliminary support for OVAL definitions. First step for change
	request #13 (Integrating the OVAL interpreter ovaldi into OpenVAS
	Server) (http://www.openvas.org/openvas-cr-13.html)

	* openvasd/oval_plugins.c: New. Supports a new class of plugins, namely
	vulnerability definitions in OVAL, the Open Vulnerability and
	Assessment Language. Only loading the definitions is supported as of
	this revision.

	* openvasd/Makefile: Updated.

	* openvasd/pluginload.c(init_plugin_classes): Added new
	oval_plugin_class.

	* openvasd/pluginload.h: Added new oval_plugin_class.

	* MANIFEST: Updated.

2008-08-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup (flaten) doc directory.

	* doc/ntp/: Removed. It was empty now.

	* doc/otp/otp_specification_10.txt: Removed. Moved one
	directory level up.

	* doc/otp_specification_10.txt: Moved here from  otp/ directory.

	* doc/otp/: Removed. It was empty now.

2008-08-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	First step of consolidating the protocol documentation
	finished.

	* doc/otp/otp_specification_10.txt: Extended and improved
	protocol documentation.

	* doc/ntp/plugin_prefs.txt, doc/ntp/ntp_extensions.txt,
	doc/ntp/README: Removed. All relevant information are now
	covered by otp_specification_10.txt.

	* MANIFEST: Updated.

2008-08-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Continued consolidation of protocol documentation.

	* doc/otp/otp_specification_10.txt: Extended and improved
	protocol documentation.

	* doc/ntp/ntp_extensions.txt:  Removed elements
	that are ported now covered by otp_specification_10.txt.

2008-08-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Continued consolidation of protocol documentation.

	* doc/otp/otp_specification_10.txt: Extended and improved
	protocol documentation.

	* doc/ntp/ntp_extensions.txt:  Removed elements
	that are ported now covered by otp_specification_10.txt.

2008-08-25  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/users.h: Corrected #define.

2008-08-25  Michael Wiegand <michael.wiegand@intevation.de>

	* MANIFEST: Updated to include doc/openvas-mkcert-client.1.

2008-08-25  Michael Wiegand <michael.wiegand@intevation.de>

	Fixes to path names used in server scripts.

	* openvas-mkcert-client.in: Corrected variable names.

	* configure.in: Changed OPENVASD_SHAREDSTATEDIR to use $localstatedir to
	avoid the use of the /com hierarchy.

	* configure: Updated.

	* openvas-mkcert.in: Retain proper definition of $localstatedir, removed
	duplicate "/lib/".

2008-08-22  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/pluginscheduler.c (hash_link_destroy): Fixed another instance
	of the memory management issue that resulted in a crash during scans.

	* openvas-adduser.in: Re-added missing prefix variables.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* packaging/debian/README.Debian: Updated and fixed some content.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* packaging/debian/README.Debian: Adjust the name of the init.d file.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* packaging/debian/README.Debian: Rebranding and changes to reflect the
	changes in OpenVAS.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* packaging/debian/README.Debian: Restore the notes for users.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* Makefile: Proper use of OPENVASD_STATEDIR in the Makefile, since using
	localstatedir does not make sense when we already have a definition
	(that can be overriden by the user if needed).

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	Added a manpage for openvas-mkcert-client similar to the one written for
	Nessus.

	* doc/openvas-mkcert-client.1: Added.

	* Makefile: Updated.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* openvas-rmuser.in: Exit without error if no errors exist.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* openvas-rmuser.in: Final fix for localstatedir definitions.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* openvas-adduser.in: Retain proper definition of localstatedir,
	reverting the change in r150 and fixing properly the definition in the
	usage in the script. Changing $localstatedir to other thing different
	from @localstatedir@ is confusing and error prone!

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* openvas-adduser.in: Should use /var/lib/openvas instead of
	/var/openvas.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* openvas-mkcert.in: Use the proper definitions to setup the location
	of the private and public CA keys.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* openvas-mkcert-client.in: Have nessus-mkcert-client warn if the server
	certificates cannot be read (happens when you are not root). Based on
	patch included in Debian since nessus-core 2.2.3-1, in February 2002.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* openvas-mkcert-client.in: Proper fix for the FHS issue, the "fix"
	introduced in release 150 actually made this script use /var/openvas/CA
	for some of the keys when it should be using /var/lib/openvas/CA instead
	(/var/openvas is not a FHS directory). This fix is based in the patch
	introduced in Debian for nessus-core (since, at least 1.2.6, 6 years
	ago).

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* openvasd/Makefile: Remove undefined variable.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* packaging/debian/changelog, packaging/debian/control: Prepare for
	packaging of 1.0.1 version.

2008-08-22  Javier Fernandez-Sanguino <jfs@debian.org>

	* packaging/debian/po/cs.po, packaging/debian/po/de.po,
	packaging/debian/po/es.po, packaging/debian/po/fr.po,
	packaging/debian/po/gl.po, packaging/debian/po/nl.po
	packaging/debian/po/pt.po, packaging/debian/po/pt_BR.po,
	packaging/debian/po/sv.po: Manually update the debian po files (change
	'nessus-mkcert' to 'openvas-mkcert') and unfuzzy the modified string in
	all languages.

	* packaging/debian/changelog: Updated.

2008-08-21  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/pluginscheduler.c (hash_add): Fixed a memory management issue
	that resulted in a crash during scans.

2008-08-11  Michael Wiegand <michael.wiegand@intevation.de>

	First step for change request #9 (Make OpenVAS use (and depend on) glib)
	(http://www.openvas.org/openvas-cr-9.html)

	* openvasd/openvasd.c: Replaced getopt command line parsing with glib
	command line parsing.

	* openvasd/Makefile: Include Libs and Cflags for glib.

	* configure: Regenerated.

	* configure.in: Added check for glib, removed check for getopt.

	* openvas.tmpl.in: Added support for glib.

	* aclocal.m4: Added support for pkg-config.

2008-08-11  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Continued consolidation of protocol documentation.

	* doc/ntp/ntp_white_paper_11.txt:  Removed. It does not contain
	any information not covered by otp_specification_10.txt
	or defined elsewhere.

	* doc/otp/otp_specification_10.txt: Extended with various
	protocol command documentation.

2008-08-10  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* doc/ntp/ntp_white_paper.txt: Removed. It does not contain
	any information not covered by otp_specification_10.txt.

	* doc/ntp/ntp_white_paper_11.txt: Removed those elements
	which are documented cleanly in otp_specification_10.txt

	* doc/otp/otp_specification_10.txt: Extended with various
	protocol command documentation.

	* MANIFEST: Updated.

2008-08-08  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Started clean documentation of OTP.

	* doc/otp/otp_specification_10.txt: Extended with various
	protocol command documentation.

	* doc/ntp/ntp_extensions.txt, doc/ntp/ntp_white_paper.txt:
	Removed those elements which are documented cleanly
	in otp_specification_10.txt

	* openvasd/comm.c (plugin_send_infos): Added comment
	hinting at a potential bug.

2008-08-08  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Patch for Change Request #15:
	http://www.openvas.org/openvas-cr-15.html
	(OpenVAS Server: Remove features for detached scans)

	* openvasd/ntp_11.c: Don't include detached.h anymore.
	(ntp_11_stop_detached_session, ntp_11_list_detached_sessions,
	extract_detached_session_key_from_session_msg): Removed.
	(ntp_11_parse_input): Removed handling of STOP_DETACHED and DETACHED_SESSIONS_LIST.
	(ntp_11_parse_input): Fixed anyway-misplaced ENABLE_SAVE_TESTS conditional.

	* openvasd/preferences.c (preferences_detached_scan, preferences_detached_scan_email,
	preferences_continuous_scan, preferences_delay_between_scans): Removed.
	(preferences_reset_cache): Removed initializing of detached params.

	* openvasd/preferences.h: Removed protos for preferences_detached_scan,
	preferences_detached_scan_email, preferences_delay_between_scans and
	preferences_continuous_scan.

	* openvasd/attack.c: Removed include for detached.h.
	(attack_network): Removed handling of "detached" and "continous".
	(attack_sigterm, arg_addset_value): Removed.

	* openvasd/hosts.c: Removed include for detached.h.
	(forward): Removed handling for detached scans.

	* Makefile: Don't handle detached module.

	* doc/ntp/ntp_extensions.txt: Removed documentation about the
	detached functionality.

	* openvasd/utils.c: Removed include for detached.h. It wasn't
	required anyway.

	* openvasd/comm.c: Removed include for detached.h. It wasn't
	required anyway.
	(comm_send_preferences): Don't send settings for ntp_detached_sessions
	anymore.

	* openvasd/detached.c, openvasd/detached.h: Removed.

	* MANIFEST: Updated.

2008-08-08  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: Set to 1.1.0.SVN to reflect that the 1.0 development
	has been branched and the development here lead to a next
	major release.

2008-08-07  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Final step of Change Request #4,
	http://www.openvas.org/openvas-cr-4.html :
	Remove plugin upload feature

	* openvasd/pluginupload.c, openvasd/pluginupload.h: Removed.

	* openvasd/Makefile: Removed handling of module pluginupload.

	* openvasd/ntp_11.c: (ntp_11_parse_input): Removed command
	ATTACHED_PLUGIN from protocol.

	* doc/openvasd.8.in: Removed documentation of "plugin_upload".

	* doc/ntp/ntp_extensions.txt: Removed description of
	ATTACHED_PLUGIN.

	* MANIFEST: Updated.

2008-08-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Branching of 1.0 series happened. The present file
	described trunk developments.

2008-07-31  Tim Brown <timb@nth-dimension.org.uk>

	* openvas-adduser.in: Now sets prefix, execprefix during build.

2008-07-07  Jan Wagner <waja@cyconet.org>

	* packaging/debian/openvasd.conf,packaging/debian/changelog:
	removed traces of Nessus in favour of OpenVAS

2008-07-07  Michael Wiegand <michael.wiegand@intevation.de>

	Removed outdated and obsolete file doc/README.INSTALL.

	* doc/README.INSTALL: Removed.

	* MANIFEST: Updated.

2008-07-03  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 1.0.2.SVN

2008-07-03  Michael Wiegand <michael.wiegand@intevation.de>

	Doing the 1.0.1 release.

	* VERSION: Set to 1.0.1.

	* CHANGES: Updated.

2008-07-03  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/control, packaging/debian/openvas-server.templates,
	packaging/debian/po/*: Fixed po files.

	* packaging/debian/openvas-server.init: Modified init info in
	openvas-server.init to include descriptions.

	* packaging/debian/changelog: Updated.

2008-07-03  Michael Wiegand <michael.wiegand@intevation.de>

	* doc/otp/otp_specification_10.txt: Made OTP specification more specific
	regarding the removal of session handling.

2008-07-02  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Raised minimum required version of openvas-libnasl
	from 0.9.1 to 1.0.1.

	* configure: Updated.

2008-07-02  Michael Wiegand <michael.wiegand@intevation.de>

	* openvasd/openvasd.c (main): Updated version and copyright information
	to make them consistent with OpenVAS-Client.

2008-07-02  Jan Wagner <waja@cyconet.org>

	Split off -dev package for Debian packaging.

	* packaging/debian/openvas-server-dev.dirs,
	packaging/debian/openvas-server.dirs,
	packaging/debian/openvas-server.docs: Added.

	* packaging/debian/dirs, packaging/debian/docs: Removed.

	* packaging/debian/changelog, packaging/debian/control,
	packaging/debian/rules: Added documentation and handling for -dev
	Package.

2008-07-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: Updated.

	* openvasd/detached.c (detached_new_session): Fixed wrong use of system
	call "open" (if O_CREAT is applied, the command needs specification of
	access flags).

2008-06-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd-config.in: fix variable replacement problem.
	Original problem report and initial patch supplied by
	Ales Nosek.

2008-06-24  Michael Wiegand <michael.wiegand@intevation.de>

	Added a first draft of the OTP specification.

	* doc/otp/: Added.

	* doc/otp/otp_specification_10.txt: Added.

2008-06-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/users.c (users_add_rule): Fixed overflow problem.
	Found by Ales Nosek.

2008-06-19  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/control: Minor updates to control file, fixed
	Section, Priority and Build-Depends directives.

2008-06-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* doc/kb_saving.txt: Changed some history naming back from
	OpenVAS to Nessus (probably a search-replace mistake).
	Also removed a documentation URL to nessus.org where
	the page has been removed meanwhile.

2008-05-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Second step for Change Request #4 (Remove plugin upload feature),
	http://www.openvas.org/openvas-cr-4.html

	* MANIFEST: Added packaging/debian

	* openvasd/pluginupload.c, openvasd/pluginupload.h: Added
	note about when this module can be removed.

	* openvasd/ntp_11.c (ntp_11_read_prefs): remove
	consideration of system preferences "admin_user",
	"plugin_upload" and "plugin_upload_suffixes".
	(ntp_11_parse_input): Remove undocumented protocol
	command "HUP_FATHER".

	* openvasd/preferences.c (preferences_new):
	Removed write defaults for these system preferences:
	"admin_user", "plugin_upload" and "plugin_upload_suffixes".
	(preferences_upload_enabled, preferences_upload_suffixes,
	preferences_user_is_admin): Removed.
	(preferences_reset_cache): Removed call of
	preferences_upload_enabled.

	* openvasd/preferences.h: Removed protos for
	preferences_user_is_admin, preferences_upload_enabled
	and preferences_upload_suffixes.

	* openvasd/comm.c (comm_send_preferences): No need of
	exception for "admin_user" any more.

	* openvasd/utils.c (get_max_hosts_number, get_max_checks_number): Removed
	allowance of overridung max_checks and max_hosts when
	being defined a admin user.

	* openvas-adduser.in: Removed the creation of the users
	plugins directory.
	Also removed any unused variable setttings via configure.

2008-05-11  Tim Brown  <timb@nth-dimension.org.uk>

	* debian: Removed as it will be replaced with packaging/debian.
	* packaging/debian: New. Debian packaging files.
	* doc/unbsp.c: Removed as no longer used.

2008-05-08  Bernhard Herzog  <bh@intevation.de>

	First step for Change Request #4 (Remove plugin upload feature),
	http://www.openvas.org/openvas-cr-4.html

	* openvasd/pluginupload.c (plugin_recv): Always discard the
	uploaded data and reject the plugin upload.  This change removes
	support for plugin upload without changing the protocol
	(plugins_homedir): Removed. No longer used.

2008-05-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/ntp.h: Removed. The contents is now in "ntp.h" of
	the openvas-libraries module.

	* include/openvas-devel.h: Removed. The content was redundant
	anyway (error prone!) and now is only in ntp.h of module
	openvas-libraries.

	* include/includes.h: Instead of openvas-devel.h now include ntp.h.

	* configure.in: Raised minimum required version of openvas-libraries
	from 1.0.0 to 1.0.2.

	* Makefile: Don't install openvas-devel.h anymore.

	* MANIFEST: Updated.

	* configure: Updated.

2008-04-18  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* packaging/fedora: New. Directory for Fedora RPM files.

	* packaging/fedora/openvas-server-1.0.0-1.fc8.openvas.spec,
	packaging/fedora/openvas-server-1.0.0-Makefile.diff: New.

	* MANIFEST: updated.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* packaging: New. Directory for packaging files.
	* packaging/opensuse: New. Directory for OpenSUSE RPM files.
	* packaging/opensuse/openvas-server-1.0.0-1.suse102.openvas.spec,
	packaging/opensuse/openvas-server-1.0.0-Makefile.diff: New.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile: Add missing DESTDIR for install targets.

2008-02-26  Tim Brown <timb@nth-dimension.org.uk>

	* openvasd/log.c, openvasd/preferences.c, doc/openvasd.8.in: Now
	supports syslog as per Nessus 2.3.1.
	* openvasd/log.c: Fixed possible NULL pointer exception.
	* openvasd/pluginload.c: Fixed typo in error message.
	* openvas-server/openvasd/comm.c: Removed unused variable.
	* openvas-server/openvasd/pluginscheduler.c: Fixed memory leaks as
	per Nessus 2.3.1.

2008-02-17  Tim Brown <timb@nth-dimension.org.uk>

	* openvasd/Makefile: Fixed bug preventing parallel builds under
	Gentoo.

2008-02-16  Laban Mwangi <labeneator@gmail.com>

	* openvasd/detached.c(detached_setup_mail_file): Fixing flawfinder l5
	warnings.

2008-02-11  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* CHANGES: Removed one item for 1.0.0 about gpgme, because
	it did not belong there.

2008-01-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Post release version bump.

	* VERSION: Set to 1.0.1.SVN

2008-01-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the 1.0.0 release.

	* VERSION: Set to 1.0.0.

	* CHANGES: Updated.

2008-01-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* UPGRADE_README: Removed. Nowadays such information are not relevant
	anymore.

	* MANIFEST: updated.

2008-01-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* doc/stubheader.txt: Removed. The stub headers are mangaged centralized
	in the "doc" module of OpenVAS SVN.

	* TODO: Removed an ancient entry about a fetch script that
	isn't part of this module.

	* MANIFEST: updated.

2007-11-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/openvasd.c (main): Removed useless version check
	for libraries and nasl.

2007-11-07  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Post release version bump.

	* VERSION: Set to 0.9.3.SVN

2007-11-07  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the 0.9.2 release.

	* VERSION: Set to 0.9.2.

	* CHANGES: Updated.

2007-11-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd-config.in: Added header.

	* configure.in: Added header and fixed version setting as used
	for openvas-config.

	* include/corevers.h.in: Adapt parameter names according to changes
	in configure.in

	* configure: updated.

2007-11-05  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile: Added creation of gnupg subdirectory under sysconfdir/openvas.

2007-10-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: updated.

2007-10-21  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* README_SSL, doc/WARNING.En, doc/WARNING.Fr: Removed due
	to phrases that render the text files non-free.

2007-10-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Post release version bump.

	* VERSION: Set to 0.9.2.SVN

2007-10-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the 0.9.1 release.

	* VERSION: Set to 0.9.1.

	* CHANGES: Updated.

2007-10-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in, openvas.tmpl.in: Removed variable "nessus_lib".
	It wasn't used anyway.

	* configure: Updated.

2007-10-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in: Added version checks for openvas-libraries
	and openvas-libnasl.

	* TODO: Removed wish for version checking.

2007-10-15  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: Added some further items.

2007-10-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: upgraded to 0.9.0.SVN.

2007-10-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: updated.

2007-10-08  Bernhard Herzog  <bh@intevation.de>

	* openvasd/hosts_gatherer.h: Removed.  Use the one installed by
	openvas-libraries instead.

	* attack.c: #include <hg_utils.h> and move the
	hosts_gatherer.h include because it now comes from outside of
	openvasd.

	* openvasd/openvasd.c, openvasd/preferences.c: Move the
	hosts_gatherer.h include because it now comes from outside of
	openvasd.

2007-09-20  Bernhard Herzog  <bh@intevation.de>

	* openvasd/pluginload.c (init_plugin_classes)
	(plugins_reload_from_dir): Refactor the initialization of the
	plugin classes to from plugins_reload_from_dir into the new
	function init_plugin_classes

2007-07-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the 0.9.0 release.

	* VERSION: Set to 0.9.0.

	* CHANGES: Set release date to 2007-07-27.

2007-07-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/preferences.c (preferences_new): Defaulting
	nasl_no_signature_checks to yes, because the signatures
	are currently not present.

2007-07-21  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* INSTALL: just slight correction and attached a warning
	that this is outdated.

2007-07-21  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: updated.

2007-07-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Remove support for Unix Sockets for communication between client and
	server. Since SSL support is present, this is not needed anymore for
	security reasons. Considerable performance loss is not expected, only
	at first connection time it might be faster with unix sockets (which
	is not really for sure since the loopback device is also very fast).
	Also, the implementation is suboptimal anyway because it works
	as compile-time option. It is very easy to select between a
	unix domain socket and inet socket at runtime.

	* configure.in: Removed unix-socket handling.

	* configure: updated.

	* include/config.h.in, openvasd/sighand.c, openvasd/preferences.c,
	openvasd/openvasd.c, openvasd/ntp_11.c, openvasd/hosts.c:
	Removed any handling of unix
	sockets (this also removes any occurance of USE_AF_UNIX,
	OPENVAS_ON_SSL, AF_UNIX_PATH, USE_AF_INET, AD_UNIX)

	* openvasd/comm.c: Remove handling for non-SSL conncetions.

2007-07-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* CHANGES: Updated with some notes.

2007-07-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd/openvasd.c (main): Removed HAVE_SSL remains.

	* Makefile: Removed installation of "nessus-services". This module
	does not need to care about libdir (creation removed)

	* TODO: cleaned a bit.

2007-07-18  Bernhard Herzog  <bh@intevation.de>

	* include/includes.h: Remove openssl includes

2007-07-18  Bernhard Herzog  <bh@intevation.de>

	* openvasd/openvas-check-signature.c: Use GnuTLS instead of
	OpenSSL.  See comments in the file for things that could be done
	better.
	(print_tls_error, map_file, hexdecode): New.  Helper functions.
	(generate_signature, verify_signature): Use GnuTLS instead of
	OpenSSL.  Also, both functions now have an additional parameter
	for the keyfile/certfile to use so that their filenames are no
	longer hard wired.
	(main): Add command line arguments to specifiy the key or
	certificat to use when signing or verifying.  Pass those filenames
	to generate_signature and verify_signature.

2007-07-04  Bernhard Herzog  <bh@intevation.de>

	* openvasd/plugs_hash.c (plugins_hash): Handle errors from
	gcry_md_open.  plugins_hash may return NULL now.

	* openvasd/comm.c (comm_send_md5_plugins): Handle case where
	plugins_hash returns NULL.

2007-07-02  Bernhard Herzog  <bh@intevation.de>

	* openvasd/plugs_hash.c (file_hash, plugins_hash): Use unsigned
	char (pointer/array) to hold the digest to avoid warnings about
	type mismatch.

2007-07-02  Bernhard Herzog  <bh@intevation.de>

	* openvasd/md5.c, openvasd/md5.c: removed. no longer needed.

	* openvasd/Makefile: md5.c has been removed.

	* openvasd/comm.c: Do not included md5.h.  it wasn't needed anyway

2007-07-02  Bernhard Herzog  <bh@intevation.de>

	* openvasd/users.c remove includes of openssl headers.
	(check_user): Use libgcrypt to compute md5 sums.

	* openvasd/plugs_hash.c (md5sum_hex): New function to convert a
	binary md5 sum to hexadecimal.
	(file_hash, dir_plugins_hash, plugins_hash): Use libgcrypt to
	compute md5 sums.

2007-07-02  Bernhard Herzog  <bh@intevation.de>

	* openvasd/openvasd.c: Use the libopenvas ssl abstraction instead
	of openssl. As a consequence the ssl_cipher_list config option is
	no longer supported.
	(ssl_mt, ssl_ctx): Removed.
	(ovas_server_ctx): Introduced instead of ssl_mt and ssl_ctx
	(server_thread): Use the libopenvas ssl abstraction instead of
	openssl.
	(verify_callback): removed. verification is done in libopenvas.
	(main_loop): Use the libopenvas ssl abstraction instead of
	openssl.

2007-07-02  Bernhard Herzog  <bh@intevation.de>

	* openvasd/preferences.c: Always compile in
	preferences_get_string, i.e. do not depend on OPENVAS_ON_SSL being
	defined.

2007-06-22  Bernhard Herzog  <bh@intevation.de>

	* include/config.h, include/corevers.h: Removed from SVN because
	they're automatically generated by the configure script

2007-05-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure, include/config.h, include/corevers.h: Updated.

2007-05-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/threadcompat.h: Fix names and description to reflect
	thread as subject.

	* include/includes.h: Replace libnessus.h by libopenvas.h.

2007-05-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/ntcompat.h: Removed. Renamed to threadcompat.h
	because in fact it is about threads.

	* include/threadcompat.h: New. Previous ntcompat.h.

	* Makefile, MANIFEST, include/includes.h: Renamed ntcompat.h
	to threadcompat.h

2007-05-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/ntcompat.h: Remove now useless emtpy defines for
	PlugExport, DllExport, DllImport and ExtFunc. Remove
	alias print_error for printf which was not used strictly
	anyway.

	* openvasd/log.c, openvasd/openvasd.c, openvasd/pluginload.c,
	openvasd/preferences.c: Replaced print_error by printf.

2007-05-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/includes.h, include/openvas-devel.h, openvasd/sighand.c:
	Remove any consideration of NESSUSNT.

	* include/ntcompat.h: Remove any consideration of NESSUSNT and
	USE_NT_THREADS.

	* configure.in: Removed handlung for SSL presence, because
	it is now mandatory.

2007-05-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in, openvas-adduser.in, openvas-rmuser.in,
	openvas-mkcert.in, openvas-mkcert-client.in: Remove Cygwin stuff.

2007-05-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure: Updated.

2007-05-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in, openvas.tmpl.in, openvasd/Makefile: Replace
	use of nessus-libraries and libnasl by openvas-libraries
	and openvas-libnasl. This includes name change of the respective
	variables for the respective config scripts.

	* VERSION: Set back to 0.9.0. OpenVAS wasn't that far yet.

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvasd-config.in, configure.in, Makefile: Removed
	DESTDIR. It looks pretty useless as it needs to
	be set in the shell. It was introduced in Nessus 1.3.1.

	* ChangeLog: New. Started ChangeLog file.
