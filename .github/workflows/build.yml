name: "Build"

on: [workflow_call]

jobs:
  C:
    runs-on: ubuntu-latest
    container:
      image: registry.community.greenbone.net/community/gvm-libs:stable
    steps:
      - uses: actions/checkout@v5
      - name: install dependencies
        run: |
          sh .github/install-openvas-dependencies.sh
      - name: build 
        run: |
          cmake -Bbuild -DCMAKE_C_COMPILER=/usr/share/clang/scan-build-19/libexec/ccc-analyzer
          cmake --build build
  Rust:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5
      - uses: ./.github/actions/setup-rust
      # we just check if it is compilable, the actual compilation is now done in:
      # - in the Dockefiles
      # - in functional.yml (x86_64) only
      # - in release.yml (aarch64, x86_64)
      - run: cargo check
        working-directory: rust
